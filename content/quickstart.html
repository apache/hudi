<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="hudi, quickstart">
<title>Quickstart | Hudi</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-93561550-1', 'auto');
  ga('send', 'pageview');

</script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://0.0.0.0:4000feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a class="fa fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle">
              <img src="https://www.apache.org/img/hudi.png" alt="Hudi logo"/>
              <!--Hudi-->
            </span><br/>
            <p class="navbar-incubate">(Incubating)</p></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                

                
                
                
                <li><a href="news">News</a></li>
                
                
                
                <li><a href="community.html">Community</a></li>
                
                
                
                <li><a href="https://github.com/apache/incubator-hudi" target="_blank">Code</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="contributing.html">Contributing</a></li>
                        
                        
                        
                        <li><a href="https://cwiki.apache.org/confluence/display/HUDI" target="_blank">Wiki/Designs</a></li>
                        
                        
                        
                        <li><a href="https://issues.apache.org/jira/projects/HUDI/summary" target="_blank">Issues</a></li>
                        
                        
                        
                        <li><a href="https://cwiki.apache.org/confluence/pages/viewrecentblogposts.action?key=HUDI" target="_blank">Blog</a></li>
                        
                        
                        
                        <li><a href="https://projects.apache.org/project.html?incubator-hudi" target="_blank">Team</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:dev@hudi.apache.org?subject=Hudi Documentation feedback&body=I have some feedback about the Quickstart page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

<li>

		
                <li>
                    
                    <!-- link to the Chinese home page when current is blog page -->
                    <a href="/cn/quickstart.html">中文版</a>
                    
                </li>
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Quickstart">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          








<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Latest Version</li>
    
    
    
    <li>
        <a href="#">Getting Started</a>
        <ul>
            
            
            
            <li class="active"><a href="quickstart.html">Quickstart</a></li>
            
            
            
            
            
            
            <li><a href="use_cases.html">Use Cases</a></li>
            
            
            
            
            
            
            <li><a href="powered_by.html">Talks & Powered By</a></li>
            
            
            
            
            
            
            <li><a href="comparison.html">Comparison</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Documentation</a>
        <ul>
            
            
            
            <li><a href="concepts.html">Concepts</a></li>
            
            
            
            
            
            
            <li><a href="writing_data.html">Writing Data</a></li>
            
            
            
            
            
            
            <li><a href="querying_data.html">Querying Data</a></li>
            
            
            
            
            
            
            <li><a href="configurations.html">Configuration</a></li>
            
            
            
            
            
            
            <li><a href="performance.html">Performance</a></li>
            
            
            
            
            
            
            <li><a href="admin_guide.html">Administering</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Quickstart</h1>
</div>



<div class="post-content">

   

    


    

  <p><br />
To get a quick peek at Hudi’s capabilities, we have put together a <a href="https://www.youtube.com/watch?v=VhNgUsxdrD0">demo video</a> 
that showcases this on a docker based setup with all dependent systems running locally. We recommend you replicate the same setup 
and run the demo yourself, by following steps <a href="docker_demo.html">here</a>. Also, if you are looking for ways to migrate your existing data to Hudi, 
refer to <a href="migration_guide.html">migration guide</a>.</p>

<p>If you have Hive, Hadoop, Spark installed already &amp; prefer to do it on your own setup, read on.</p>

<h2 id="download-hudi">Download Hudi</h2>

<p>Check out <a href="https://github.com/apache/incubator-hudi">code</a> and normally build the maven project, from command line</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mvn clean install -DskipTests -DskipITs
</code></pre></div></div>

<p>To work with older version of Hive (pre Hive-1.2.1), use</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mvn clean install -DskipTests -DskipITs -Dhive11
</code></pre></div></div>

<p>For IDE, you can pull in the code into IntelliJ as a normal maven project. 
You might want to add your spark jars folder to project dependencies under ‘Module Setttings’, to be able to run from IDE.</p>

<h3 id="version-compatibility">Version Compatibility</h3>

<p>Hudi requires Java 8 to be installed on a *nix system. Hudi works with Spark-2.x versions. 
Further, we have verified that Hudi works with the following combination of Hadoop/Hive/Spark.</p>

<table>
  <thead>
    <tr>
      <th>Hadoop</th>
      <th>Hive</th>
      <th>Spark</th>
      <th>Instructions to Build Hudi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2.6.0-cdh5.7.2</td>
      <td>1.1.0-cdh5.7.2</td>
      <td>spark-2.[1-3].x</td>
      <td>Use “mvn clean install -DskipTests -Dhadoop.version=2.6.0-cdh5.7.2 -Dhive.version=1.1.0-cdh5.7.2”</td>
    </tr>
    <tr>
      <td>Apache hadoop-2.8.4</td>
      <td>Apache hive-2.3.3</td>
      <td>spark-2.[1-3].x</td>
      <td>Use “mvn clean install -DskipTests”</td>
    </tr>
    <tr>
      <td>Apache hadoop-2.7.3</td>
      <td>Apache hive-1.2.1</td>
      <td>spark-2.[1-3].x</td>
      <td>Use “mvn clean install -DskipTests”</td>
    </tr>
  </tbody>
</table>

<p>If your environment has other versions of hadoop/hive/spark, please try out Hudi 
and let us know if there are any issues.</p>

<h2 id="generate-sample-dataset">Generate Sample Dataset</h2>

<h3 id="environment-variables">Environment Variables</h3>

<p>Please set the following environment variables according to your setup. We have given an example setup with CDH version</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd incubator-hudi 
export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64/jre/
export HIVE_HOME=/var/hadoop/setup/apache-hive-1.1.0-cdh5.7.2-bin
export HADOOP_HOME=/var/hadoop/setup/hadoop-2.6.0-cdh5.7.2
export HADOOP_INSTALL=/var/hadoop/setup/hadoop-2.6.0-cdh5.7.2
export HADOOP_CONF_DIR=$HADOOP_INSTALL/etc/hadoop
export SPARK_HOME=/var/hadoop/setup/spark-2.3.1-bin-hadoop2.7
export SPARK_INSTALL=$SPARK_HOME
export SPARK_CONF_DIR=$SPARK_HOME/conf
export PATH=$JAVA_HOME/bin:$HIVE_HOME/bin:$HADOOP_HOME/bin:$SPARK_INSTALL/bin:$PATH
</code></pre></div></div>

<h3 id="run-hoodiejavaapp">Run HoodieJavaApp</h3>

<p>Run <strong>hudi-spark/src/test/java/HoodieJavaApp.java</strong> class, to place a two commits (commit 1 =&gt; 100 inserts, commit 2 =&gt; 100 updates to previously inserted 100 records) onto your DFS/local filesystem. Use the wrapper script
to run from command-line</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd hudi-spark
./run_hoodie_app.sh --help
Usage: &lt;main class&gt; [options]
  Options:
    --help, -h
       Default: false
    --table-name, -n
       table name for Hudi sample table
       Default: hoodie_rt
    --table-path, -p
       path for Hudi sample table
       Default: file:///tmp/hoodie/sample-table
    --table-type, -t
       One of COPY_ON_WRITE or MERGE_ON_READ
       Default: COPY_ON_WRITE
</code></pre></div></div>

<p>The class lets you choose table names, output paths and one of the storage types. In your own applications, be sure to include the <code class="highlighter-rouge">hudi-spark</code> module as dependency
and follow a similar pattern to write/read datasets via the datasource.</p>

<h2 id="query-a-hudi-dataset">Query a Hudi dataset</h2>

<p>Next, we will register the sample dataset into Hive metastore and try to query using <a href="#hive">Hive</a>, <a href="#spark">Spark</a> &amp; <a href="#presto">Presto</a></p>

<h3 id="start-hive-server-locally">Start Hive Server locally</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hdfs namenode # start name node
hdfs datanode # start data node

bin/hive --service metastore  # start metastore
bin/hiveserver2 \
  --hiveconf hive.root.logger=INFO,console \
  --hiveconf hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat \
  --hiveconf hive.stats.autogather=false \
  --hiveconf hive.aux.jars.path=/path/to/packaging/hudi-hive-bundle/target/hudi-hive-bundle-0.4.6-SNAPSHOT.jar

</code></pre></div></div>

<h3 id="run-hive-sync-tool">Run Hive Sync Tool</h3>
<p>Hive Sync Tool will update/create the necessary metadata(schema and partitions) in hive metastore. This allows for schema evolution and incremental addition of new partitions written to.
It uses an incremental approach by storing the last commit time synced in the TBLPROPERTIES and only syncing the commits from the last sync commit time stored.
Both <a href="writing_data.html#datasource-writer">Spark Datasource</a> &amp; <a href="writing_data.html#deltastreamer">DeltaStreamer</a> have capability to do this, after each write.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd hudi-hive
./run_sync_tool.sh
  --user hive
  --pass hive
  --database default
  --jdbc-url "jdbc:hive2://localhost:10010/"
  --base-path tmp/hoodie/sample-table/
  --table hoodie_test
  --partitioned-by field1,field2

</code></pre></div></div>
<p>For some reason, if you want to do this by hand. Please 
follow <a href="https://cwiki.apache.org/confluence/display/HUDI/Registering+sample+dataset+to+Hive+via+beeline">this</a>.</p>

<h3 id="hive">HiveQL</h3>

<p>Let’s first perform a query on the latest committed snapshot of the table</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hive&gt; set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
hive&gt; set hive.stats.autogather=false;
hive&gt; add jar file:///path/to/hudi-hive-bundle-0.4.6-SNAPSHOT.jar;
hive&gt; select count(*) from hoodie_test;
...
OK
100
Time taken: 18.05 seconds, Fetched: 1 row(s)
hive&gt;
</code></pre></div></div>

<h3 id="spark">SparkSQL</h3>

<p>Spark is super easy, once you get Hive working as above. Just spin up a Spark Shell as below</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd $SPARK_INSTALL
$ spark-shell --jars $HUDI_SRC/packaging/hudi-spark-bundle/target/hudi-spark-bundle-0.4.6-SNAPSHOT.jar --driver-class-path $HADOOP_CONF_DIR  --conf spark.sql.hive.convertMetastoreParquet=false --packages com.databricks:spark-avro_2.11:4.0.0

scala&gt; val sqlContext = new org.apache.spark.sql.SQLContext(sc)
scala&gt; sqlContext.sql("show tables").show(10000)
scala&gt; sqlContext.sql("describe hoodie_test").show(10000)
scala&gt; sqlContext.sql("describe hoodie_test_rt").show(10000)
scala&gt; sqlContext.sql("select count(*) from hoodie_test").show(10000)
</code></pre></div></div>

<h3 id="presto">Presto</h3>

<p>Checkout the ‘master’ branch on OSS Presto, build it, and place your installation somewhere.</p>

<ul>
  <li>Copy the hudi/packaging/hudi-presto-bundle/target/hudi-presto-bundle-*.jar into $PRESTO_INSTALL/plugin/hive-hadoop2/</li>
  <li>Startup your server and you should be able to query the same Hive table via Presto</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>show columns from hive.default.hoodie_test;
select count(*) from hive.default.hoodie_test
</code></pre></div></div>

<h3 id="incremental-hiveql">Incremental HiveQL</h3>

<p>Let’s now perform a query, to obtain the <strong>ONLY</strong> changed rows since a commit in the past.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hive&gt; set hoodie.hoodie_test.consume.mode=INCREMENTAL;
hive&gt; set hoodie.hoodie_test.consume.start.timestamp=001;
hive&gt; set hoodie.hoodie_test.consume.max.commits=10;
hive&gt; select `_hoodie_commit_time`, rider, driver from hoodie_test where `_hoodie_commit_time` &gt; '001' limit 10;
OK
All commits :[001, 002]
002	rider-001	driver-001
002	rider-001	driver-001
002	rider-002	driver-002
002	rider-001	driver-001
002	rider-001	driver-001
002	rider-002	driver-002
002	rider-001	driver-001
002	rider-002	driver-002
002	rider-002	driver-002
002	rider-001	driver-001
Time taken: 0.056 seconds, Fetched: 10 row(s)
hive&gt;
hive&gt;
</code></pre></div></div>

<p>This is only supported for Read-optimized view for now.”</p>


    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_quickstart.html" class="btn btn-default navbar-btn cursorNorm" role="button">quickstart</a>
        
        
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
                  <p>
                  Copyright &copy; <span id="copyright-year">2019</span> <a href="https://apache.org">The Apache Software Foundation</a>,
                  Licensed under the Apache License, Version 2.0<br>
                  Apache and the Apache feather logo are trademarks of The Apache Software Foundation.| <a href="/privacy">Privacy Policy</a><br>
                  <a class="footer-link-img" href="https://apache.org">
                    <img src="images/asf_logo.svg" alt="The Apache Software Foundation" height="100px" widh="50px"></a>
                  </p>
                  <p>
                  Apache Hudi is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the <a href="http://incubator.apache.org/">Apache Incubator</a>.
                  Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have
                  stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a
                  reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
                  </p>
                </div>
                <div class="col-lg-12 footer">
                  <div class="ui link list">
                    <a class="item" rel="external" href="https://incubator.apache.org/"> Apache Incubator </a>
                    <a class="item" rel="external" href="https://www.apache.org/"> About the ASF </a>
                    <a class="item" rel="external" href="https://www.apache.org/events/current-event"> Events </a>
                    <a class="item" rel="external" href="https://www.apache.org/foundation/thanks.html"> Thanks </a>
                    <a class="item" rel="external" href="https://www.apache.org/foundation/sponsorship.html"> Become a Sponsor </a>
                    <a class="item" rel="external" href="https://www.apache.org/security/"> Security </a>
                    <a class="item" rel="external" href="https://www.apache.org/licenses/"> License </a>
                  </div>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

</html>
