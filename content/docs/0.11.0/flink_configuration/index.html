<!doctype html>
<html class="docs-version-0.11.0" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Hudi: User-Facing Analytics RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Hudi: User-Facing Analytics Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Apache Hudi: User-Facing Analytics JSON Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache Hudi" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Comfortaa|Ubuntu|Roboto|Source+Code+Pro">
<link rel="stylesheet" href="https://at-ui.github.io/feather-font/css/iconfont.css"><title data-react-helmet="true">Flink Setup | Apache Hudi</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://hudi.apache.org/docs/0.11.0/flink_configuration"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="0.11.0"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-0.11.0"><meta data-react-helmet="true" property="og:title" content="Flink Setup | Apache Hudi"><meta data-react-helmet="true" name="description" content="Global Configurations"><meta data-react-helmet="true" property="og:description" content="Global Configurations"><link data-react-helmet="true" rel="icon" href="/assets/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hudi.apache.org/docs/0.11.0/flink_configuration"><link data-react-helmet="true" rel="alternate" href="https://hudi.apache.org/docs/0.11.0/flink_configuration" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://hudi.apache.org/cn/docs/0.11.0/flink_configuration" hreflang="cn"><link data-react-helmet="true" rel="alternate" href="https://hudi.apache.org/docs/0.11.0/flink_configuration" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.975cb223.css">
<link rel="preload" href="/assets/js/runtime~main.859336ce.js" as="script">
<link rel="preload" href="/assets/js/main.b73afdec.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">⭐️ If you like Apache Hudi, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/apache/hudi">GitHub</a>! ⭐</div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedImage_TMUO themedImage--dark_uzRr"></div></a><a class="navbar__item navbar__link" href="/docs/overview">Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/talks">Talks</a></li><li><a class="dropdown__link" href="/docs/faq">FAQ</a></li><li><a href="https://cwiki.apache.org/confluence/display/HUDI" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Technical Wiki<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Contribute</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contribute/how-to-contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/contribute/developer-setup">Developer Setup</a></li><li><a class="dropdown__link" href="/contribute/rfc-process">RFC Process</a></li><li><a class="dropdown__link" href="/contribute/report-security-issues">Report Security Issues</a></li><li><a href="https://issues.apache.org/jira/projects/HUDI/summary" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Report Issues<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/get-involved">Get Involved</a></li><li><a class="dropdown__link" href="/community/syncs">Community Syncs</a></li><li><a class="dropdown__link" href="/community/team">Team</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/powered-by">Who&#x27;s Using</a><a class="navbar__item navbar__link" href="/roadmap">Roadmap</a><a class="navbar__item navbar__link" href="/releases/download">Download</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs/0.11.0/overview">0.11.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/flink_configuration">Current</a></li><li><a class="dropdown__link" href="/docs/flink_configuration">0.11.1</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/0.11.0/flink_configuration">0.11.0</a></li><li><a class="dropdown__link" href="/docs/0.10.1/flink_configuration">0.10.1</a></li><li><a class="dropdown__link" href="/docs/0.10.0/flink_configuration">0.10.0</a></li><li><a class="dropdown__link" href="/docs/0.9.0/overview">0.9.0</a></li><li><a class="dropdown__link" href="/docs/0.8.0/overview">0.8.0</a></li><li><a class="dropdown__link" href="/docs/0.7.0/overview">0.7.0</a></li><li><a class="dropdown__link" href="/docs/0.6.0/quick-start-guide">0.6.0</a></li><li><a class="dropdown__link" href="/docs/0.5.3/quick-start-guide">0.5.3</a></li><li><a class="dropdown__link" href="/docs/0.5.2/quick-start-guide">0.5.2</a></li><li><a class="dropdown__link" href="/docs/0.5.1/quick-start-guide">0.5.1</a></li><li><a class="dropdown__link" href="/docs/0.5.0/quick-start-guide">0.5.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_EbrZ"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/0.11.0/flink_configuration" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/cn/docs/0.11.0/flink_configuration" target="_self" rel="noopener noreferrer" class="dropdown__link">Chinese</a></li></ul></div><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://twitter.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-twitter-link" aria-label="Hudi Twitter Handle"></a><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-1d5zjsfl3-d_TefVaGyvEe16EANrxz6Q" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-slack-link" aria-label="Hudi Slack Channel"></a><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/0.11.0/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/0.11.0/quick-start-guide">Quick Start</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/quick-start-guide">Spark Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/flink-quick-start-guide">Flink Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/docker_demo">Docker Demo</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/0.11.0/timeline">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/0.11.0/table_management">How To</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/0.11.0/table_management">SQL</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/writing_data">Writing Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/hoodie_deltastreamer">Streaming Ingestion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/querying_data">Querying Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/0.11.0/flink_configuration">Flink Setup</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/0.11.0/syncing_aws_glue_data_catalog">Syncing to Catalogs</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/0.11.0/migration_guide">Services</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/0.11.0/configurations">Configurations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/0.11.0/query_engine_setup">Guides</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/0.11.0/use_cases">Use Cases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/0.11.0/faq">FAQs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/0.11.0/privacy">Privacy Policy</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apache Hudi<!-- --> <b>0.11.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/flink_configuration">latest version</a></b> (<!-- -->0.11.1<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->0.11.0</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Flink Setup</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="global-configurations">Global Configurations<a class="hash-link" href="#global-configurations" title="Direct link to heading">​</a></h2><p>When using Flink, you can set some global configurations in <code>$FLINK_HOME/conf/flink-conf.yaml</code></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="parallelism">Parallelism<a class="hash-link" href="#parallelism" title="Direct link to heading">​</a></h3><table><thead><tr><th>Option Name</th><th>Default</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>taskmanager.numberOfTaskSlots</code></td><td><code>1</code></td><td><code>Integer</code></td><td>The number of parallel operator or user function instances that a single TaskManager can run. We recommend setting this value &gt; 4, and the actual value needs to be set according to the amount of data</td></tr><tr><td><code>parallelism.default</code></td><td><code>1</code></td><td><code>Integer</code></td><td>The default parallelism used when no parallelism is specified anywhere (default: 1). For example, If the value of <a href="#parallelism-1"><code>write.bucket_assign.tasks</code></a> is not set, this value will be used</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="memory">Memory<a class="hash-link" href="#memory" title="Direct link to heading">​</a></h3><table><thead><tr><th>Option Name</th><th>Default</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>jobmanager.memory.process.size</code></td><td><code>(none)</code></td><td><code>MemorySize</code></td><td>Total Process Memory size for the JobManager. This includes all the memory that a JobManager JVM process consumes, consisting of Total Flink Memory, JVM Metaspace, and JVM Overhead</td></tr><tr><td><code>taskmanager.memory.task.heap.size</code></td><td><code>(none)</code></td><td><code>MemorySize</code></td><td>Task Heap Memory size for TaskExecutors. This is the size of JVM heap memory reserved for write cache</td></tr><tr><td><code>taskmanager.memory.managed.size</code></td><td><code>(none)</code></td><td><code>MemorySize</code></td><td>Managed Memory size for TaskExecutors. This is the size of off-heap memory managed by the memory manager, reserved for sorting and RocksDB state backend. If you choose RocksDB as the state backend, you need to set this memory</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="checkpoint">Checkpoint<a class="hash-link" href="#checkpoint" title="Direct link to heading">​</a></h3><table><thead><tr><th>Option Name</th><th>Default</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>execution.checkpointing.interval</code></td><td><code>(none)</code></td><td><code>Duration</code></td><td>Setting this value as <code>execution.checkpointing.interval = 150000ms</code>, 150000ms = 2.5min. Configuring this parameter is equivalent to enabling the checkpoint</td></tr><tr><td><code>state.backend</code></td><td><code>(none)</code></td><td><code>String</code></td><td>The state backend to be used to store state. We recommend setting store state as <code>rocksdb</code> : <code>state.backend: rocksdb</code></td></tr><tr><td><code>state.backend.rocksdb.localdir</code></td><td><code>(none)</code></td><td><code>String</code></td><td>The local directory (on the TaskManager) where RocksDB puts its files</td></tr><tr><td><code>state.checkpoints.dir</code></td><td><code>(none)</code></td><td><code>String</code></td><td>The default directory used for storing the data files and meta data of checkpoints in a Flink supported filesystem. The storage path must be accessible from all participating processes/nodes(i.e. all TaskManagers and JobManagers), like hdfs and oss path</td></tr><tr><td><code>state.backend.incremental</code></td><td><code>false</code></td><td><code>Boolean</code></td><td>Option whether the state backend should create incremental checkpoints, if possible. For an incremental checkpoint, only a diff from the previous checkpoint is stored, rather than the complete checkpoint state. If store state is setting as <code>rocksdb</code>, recommending to turn on</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="table-options">Table Options<a class="hash-link" href="#table-options" title="Direct link to heading">​</a></h2><p>Flink SQL jobs can be configured through options in the <code>WITH</code> clause.
The actual datasource level configs are listed below.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="memory-1">Memory<a class="hash-link" href="#memory-1" title="Direct link to heading">​</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>When optimizing memory, we need to pay attention to the memory configuration
and the number of taskManagers, parallelism of write tasks (write.tasks : 4) first. After confirm each write task to be
allocated with enough memory, we can try to set these memory options.</p></div></div><table><thead><tr><th>Option Name</th><th>Description</th><th>Default</th><th>Remarks</th></tr></thead><tbody><tr><td><code>write.task.max.size</code></td><td>Maximum memory in MB for a write task, when the threshold hits, it flushes the max size data bucket to avoid OOM. Default <code>1024MB</code></td><td><code>1024D</code></td><td>The memory reserved for write buffer is <code>write.task.max.size</code> - <code>compaction.max_memory</code>. When total buffer of write tasks reach the threshold, the largest buffer in the memory will be flushed</td></tr><tr><td><code>write.batch.size</code></td><td>In order to improve the efficiency of writing, Flink write task will cache data in buffer according to the write bucket until the memory reaches the threshold. When reached threshold, the data buffer would be flushed out. Default <code>64MB</code></td><td><code>64D</code></td><td>Recommend to use the default settings</td></tr><tr><td><code>write.log_block.size</code></td><td>The log writer of Hudi will not flush the data immediately after receiving data. The writer flush data to the disk in the unit of <code>LogBlock</code>. Before <code>LogBlock</code> reached threshold, records will be buffered in the writer in form of serialized bytes. Default <code>128MB</code></td><td><code>128</code></td><td>Recommend to use the default settings</td></tr><tr><td><code>write.merge.max_memory</code></td><td>If write type is <code>COPY_ON_WRITE</code>, Hudi will merge the incremental data and base file data. The incremental data will be cached and spilled to disk. this threshold controls the max heap size that can be used. Default <code>100MB</code></td><td><code>100</code></td><td>Recommend to use the default settings</td></tr><tr><td><code>compaction.max_memory</code></td><td>Same as <code>write.merge.max_memory</code>, but occurs during compaction. Default <code>100MB</code></td><td><code>100</code></td><td>If it is online compaction, it can be turned up when resources are sufficient, such as setting as <code>1024MB</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="parallelism-1">Parallelism<a class="hash-link" href="#parallelism-1" title="Direct link to heading">​</a></h3><table><thead><tr><th>Option Name</th><th>Description</th><th>Default</th><th>Remarks</th></tr></thead><tbody><tr><td><code>write.tasks</code></td><td>The parallelism of writer tasks. Each write task writes 1 to <code>N</code> buckets in sequence. Default <code>4</code></td><td><code>4</code></td><td>Increases the parallelism has no effect on the number of small files</td></tr><tr><td><code>write.bucket_assign.tasks</code></td><td>The parallelism of bucket assigner operators. No default value, using Flink <code>parallelism.default</code></td><td><a href="#parallelism"><code>parallelism.default</code></a></td><td>Increases the parallelism also increases the number of buckets, thus the number of small files (small buckets)</td></tr><tr><td><code>write.index_boostrap.tasks</code></td><td>The parallelism of index bootstrap. Increasing parallelism can speed up the efficiency of the bootstrap stage. The bootstrap stage will block checkpointing. Therefore, it is necessary to set more checkpoint failure tolerance times. Default using Flink <code>parallelism.default</code></td><td><a href="#parallelism"><code>parallelism.default</code></a></td><td>It only take effect when <code>index.bootsrap.enabled</code> is <code>true</code></td></tr><tr><td><code>read.tasks</code></td><td>The parallelism of read operators (batch and stream). Default <code>4</code></td><td><code>4</code></td><td></td></tr><tr><td><code>compaction.tasks</code></td><td>The parallelism of online compaction. Default <code>4</code></td><td><code>4</code></td><td><code>Online compaction</code> will occupy the resources of the write task. It is recommended to use <a href="/docs/compaction/#flink-offline-compaction"><code>offline compaction</code></a></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="compaction">Compaction<a class="hash-link" href="#compaction" title="Direct link to heading">​</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>These are options only for <code>online compaction</code>.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Turn off online compaction by setting <code>compaction.async.enabled</code> = <code>false</code>, but we still recommend turning on <code>compaction.schedule.enable</code> for the writing job. You can then execute the compaction plan by <a href="#offline-compaction"><code>offline compaction</code></a>.</p></div></div><table><thead><tr><th>Option Name</th><th>Description</th><th>Default</th><th>Remarks</th></tr></thead><tbody><tr><td><code>compaction.schedule.enabled</code></td><td>Whether to generate compaction plan periodically</td><td><code>true</code></td><td>Recommend to turn it on, even if <code>compaction.async.enabled</code> = <code>false</code></td></tr><tr><td><code>compaction.async.enabled</code></td><td>Async Compaction, enabled by default for MOR</td><td><code>true</code></td><td>Turn off <code>online compaction</code> by turning off this option</td></tr><tr><td><code>compaction.trigger.strategy</code></td><td>Strategy to trigger compaction</td><td><code>num_commits</code></td><td>Options are <code>num_commits</code>: trigger compaction when reach N delta commits; <code>time_elapsed</code>: trigger compaction when time elapsed &gt; N seconds since last compaction; <code>num_and_time</code>: trigger compaction when both <code>NUM_COMMITS</code> and <code>TIME_ELAPSED</code> are satisfied; <code>num_or_time</code>: trigger compaction when <code>NUM_COMMITS</code> or <code>TIME_ELAPSED</code> is satisfied.</td></tr><tr><td><code>compaction.delta_commits</code></td><td>Max delta commits needed to trigger compaction, default <code>5</code> commits</td><td><code>5</code></td><td>--</td></tr><tr><td><code>compaction.delta_seconds</code></td><td>Max delta seconds time needed to trigger compaction, default <code>1</code> hour</td><td><code>3600</code></td><td>--</td></tr><tr><td><code>compaction.max_memory</code></td><td>Max memory in MB for compaction spillable map, default <code>100MB</code></td><td><code>100</code></td><td>If your have sufficient resources, recommend to adjust to <code>1024MB</code></td></tr><tr><td><code>compaction.target_io</code></td><td>Target IO per compaction (both read and write), default <code>500GB</code></td><td><code>512000</code></td><td>--</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="memory-optimization">Memory Optimization<a class="hash-link" href="#memory-optimization" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="mor">MOR<a class="hash-link" href="#mor" title="Direct link to heading">​</a></h3><ol><li><a href="#checkpoint">Setting Flink state backend to <code>rocksdb</code></a> (the default <code>in memory</code> state backend is very memory intensive).</li><li>If there is enough memory, <code>compaction.max_memory</code> can be set larger (<code>100MB</code> by default, and can be adjust to <code>1024MB</code>).</li><li>Pay attention to the memory allocated to each write task by taskManager to ensure that each write task can be allocated to the
desired memory size <code>write.task.max.size</code>. For example, taskManager has <code>4GB</code> of memory running two streamWriteFunction, so each write task
can be allocated with <code>2GB</code> memory. Please reserve some buffers because the network buffer and other types of tasks on taskManager (such as bucketAssignFunction) will also consume memory.</li><li>Pay attention to the memory changes of compaction. <code>compaction.max_memory</code> controls the maximum memory that each task can be used when compaction tasks read
logs. <code>compaction.tasks</code> controls the parallelism of compaction tasks.</li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="cow">COW<a class="hash-link" href="#cow" title="Direct link to heading">​</a></h3><ol><li><a href="#checkpoint">Setting Flink state backend to <code>rocksdb</code></a> (the default <code>in memory</code> state backend is very memory intensive).</li><li>Increase both <code>write.task.max.size</code> and <code>write.merge.max_memory</code> (<code>1024MB</code> and <code>100MB</code> by default, adjust to <code>2014MB</code> and <code>1024MB</code>).</li><li>Pay attention to the memory allocated to each write task by taskManager to ensure that each write task can be allocated to the
desired memory size <code>write.task.max.size</code>. For example, taskManager has <code>4GB</code> of memory running two write tasks, so each write task
can be allocated with <code>2GB</code> memory. Please reserve some buffers because the network buffer and other types of tasks on taskManager (such as <code>BucketAssignFunction</code>) will also consume memory.</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="write-rate-limit">Write Rate Limit<a class="hash-link" href="#write-rate-limit" title="Direct link to heading">​</a></h2><p>In the existing data synchronization, <code>snapshot data</code> and <code>incremental data</code> are send to kafka first, and then streaming write
to Hudi by Flink. Because the direct consumption of <code>snapshot data</code> will lead to problems such as high throughput and serious
disorder (writing partition randomly), which will lead to write performance degradation and throughput glitches. At this time,
the <code>write.rate.limit</code> option can be turned on to ensure smooth writing.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="options">Options<a class="hash-link" href="#options" title="Direct link to heading">​</a></h3><table><thead><tr><th>Option Name</th><th>Required</th><th>Default</th><th>Remarks</th></tr></thead><tbody><tr><td><code>write.rate.limit</code></td><td><code>false</code></td><td><code>0</code></td><td>Turn off by default</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/hudi/tree/asf-site/website/versioned_docs/version-0.11.0/flink_configuration.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/0.11.0/querying_data"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Querying Data</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/0.11.0/syncing_aws_glue_data_catalog"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AWS Glue Data Catalog</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#global-configurations" class="table-of-contents__link toc-highlight">Global Configurations</a><ul><li><a href="#parallelism" class="table-of-contents__link toc-highlight">Parallelism</a></li><li><a href="#memory" class="table-of-contents__link toc-highlight">Memory</a></li><li><a href="#checkpoint" class="table-of-contents__link toc-highlight">Checkpoint</a></li></ul></li><li><a href="#table-options" class="table-of-contents__link toc-highlight">Table Options</a><ul><li><a href="#memory-1" class="table-of-contents__link toc-highlight">Memory</a></li><li><a href="#parallelism-1" class="table-of-contents__link toc-highlight">Parallelism</a></li><li><a href="#compaction" class="table-of-contents__link toc-highlight">Compaction</a></li></ul></li><li><a href="#memory-optimization" class="table-of-contents__link toc-highlight">Memory Optimization</a><ul><li><a href="#mor" class="table-of-contents__link toc-highlight">MOR</a></li><li><a href="#cow" class="table-of-contents__link toc-highlight">COW</a></li></ul></li><li><a href="#write-rate-limit" class="table-of-contents__link toc-highlight">Write Rate Limit</a><ul><li><a href="#options" class="table-of-contents__link toc-highlight">Options</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">About</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/2021/07/21/streaming-data-lake-platform">Our Vision</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/community/team">Team</a></li><li class="footer__item"><a class="footer__link-item" href="/releases/release-0.11.1">Releases</a></li><li class="footer__item"><a class="footer__link-item" href="/releases/download">Download</a></li><li class="footer__item"><a class="footer__link-item" href="/powered-by">Who&#x27;s Using</a></li></ul></div><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/quick-start-guide">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/docker_demo">Docker Demo</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/talks">Talks</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQ</a></li><li class="footer__item"><a href="https://cwiki.apache.org/confluence/display/HUDI" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Technical Wiki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Hudi On Cloud</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/s3_hoodie">AWS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/gcs_hoodie">Google Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/oss_hoodie">Alibaba Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/azure_hoodie">Microsoft Azure</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cos_hoodie">Tencent Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/ibm_cos_hoodie">IBM Cloud</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/contribute/get-involved">Get Involved</a></li><li class="footer__item"><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-1d5zjsfl3-d_TefVaGyvEe16EANrxz6Q" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="mailto:dev-subscribe@hudi.apache.org?Subject=SubscribeToHudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List</a></li></ul></div><div class="col footer__col"><div class="footer__title">Apache</div><ul class="footer__items"><li class="footer__item"><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li><li class="footer__item"><a href="https://www.apache.org/licenses" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://hudi.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/assets/images/logo-big.png" alt="Apache Hudi™" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/assets/images/logo-big.png" alt="Apache Hudi™" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright © 2021 <a href="https://apache.org">The Apache Software Foundation</a>, Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0"> Apache License, Version 2.0</a>. <br>Hudi, Apache and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.859336ce.js"></script>
<script src="/assets/js/main.b73afdec.js"></script>
</body>
</html>