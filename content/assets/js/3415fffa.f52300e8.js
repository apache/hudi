"use strict";(self.webpackChunkhudi=self.webpackChunkhudi||[]).push([[40555],{30005:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});var r=t(95508),o=t(74848),n=t(28453);const a={title:"Monitor Hudi metrics with Datadog",excerpt:"Introducing the feature of reporting Hudi metrics via Datadog HTTP API",author:"rxu",category:"blog",tags:["how-to","metrics","apache hudi"]},s=void 0,d={authorsImageUrls:[void 0]},c=[{value:"Availability",id:"availability",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Configurations",id:"configurations",level:2},{value:"Demo",id:"demo",level:2}];function l(e){const i={a:"a",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.h2,{id:"availability",children:"Availability"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"0.6.0 (unreleased)"})}),"\n",(0,o.jsx)(i.h2,{id:"introduction",children:"Introduction"}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.a,{href:"https://www.datadoghq.com/",children:"Datadog"})," is a popular monitoring service. In the upcoming ",(0,o.jsx)(i.code,{children:"0.6.0"})," release of Apache Hudi, we will introduce the feature of reporting Hudi metrics via Datadog HTTP API, in addition to the current reporter types: Graphite and JMX."]}),"\n",(0,o.jsx)(i.h2,{id:"configurations",children:"Configurations"}),"\n",(0,o.jsx)(i.p,{children:"Similar to other supported reporters, turning on Datadog reporter requires these 2 properties."}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-properties",children:"hoodie.metrics.on=true\nhoodie.metrics.reporter.type=DATADOG\n"})}),"\n",(0,o.jsxs)(i.p,{children:["The following property sets the Datadog API site. It determines whether the requests will be sent to ",(0,o.jsx)(i.code,{children:"api.datadoghq.eu"})," (EU) or ",(0,o.jsx)(i.code,{children:"api.datadoghq.com"})," (US). Set this according to your Datadog account settings."]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-properties",children:"hoodie.metrics.datadog.api.site=EU # or US\n"})}),"\n",(0,o.jsxs)(i.p,{children:["The property ",(0,o.jsx)(i.code,{children:"hoodie.metrics.datadog.api.key"})," allows you to set the api key directly from the configuration."]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-properties",children:"hoodie.metrics.datadog.api.key=<your api key>\nhoodie.metrics.datadog.api.key.supplier=<your api key supplier>\n"})}),"\n",(0,o.jsxs)(i.p,{children:["Due to security consideration in some cases, you may prefer to return the api key at runtime. To go with this approach, implement ",(0,o.jsx)(i.code,{children:"java.util.function.Supplier<String>"})," and set the implementation's FQCN to ",(0,o.jsx)(i.code,{children:"hoodie.metrics.datadog.api.key.supplier"}),", and make sure ",(0,o.jsx)(i.code,{children:"hoodie.metrics.datadog.api.key"})," is ",(0,o.jsx)(i.em,{children:"not"})," set since it will take higher precedence."]}),"\n",(0,o.jsx)(i.p,{children:"The following property helps segregate metrics by setting different prefixes for different jobs."}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-properties",children:"hoodie.metrics.datadog.metric.prefix=<your metrics prefix>\n"})}),"\n",(0,o.jsxs)(i.p,{children:["Note that it will use ",(0,o.jsx)(i.code,{children:"."})," to delimit the prefix and the metric name. For example, if the prefix is set to ",(0,o.jsx)(i.code,{children:"foo"}),", then ",(0,o.jsx)(i.code,{children:"foo."})," will be prepended to the metric name."]}),"\n",(0,o.jsx)(i.p,{children:"There are other optional properties, which are explained in the configuration reference page."}),"\n",(0,o.jsx)(i.h2,{id:"demo",children:"Demo"}),"\n",(0,o.jsxs)(i.p,{children:["In this demo, we ran a ",(0,o.jsx)(i.code,{children:"HoodieDeltaStreamer"})," job with metrics turn on and other configurations set properly."]}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.img,{alt:"datadog metrics demo",src:t(22429).A+"",width:"752",height:"925"})}),"\n",(0,o.jsx)(i.p,{children:"As shown above, we were able to collect Hudi's action-related metrics like"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:(0,o.jsx)(i.code,{children:"<prefix>.<table name>.commit.totalScanTime"})}),"\n",(0,o.jsx)(i.li,{children:(0,o.jsx)(i.code,{children:"<prefix>.<table name>.clean.duration"})}),"\n",(0,o.jsx)(i.li,{children:(0,o.jsx)(i.code,{children:"<prefix>.<table name>.index.lookup.duration"})}),"\n"]}),"\n",(0,o.jsxs)(i.p,{children:["as well as ",(0,o.jsx)(i.code,{children:"HoodieDeltaStreamer"}),"-specific metrics"]}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:(0,o.jsx)(i.code,{children:"<prefix>.<table name>.deltastreamer.duration"})}),"\n",(0,o.jsx)(i.li,{children:(0,o.jsx)(i.code,{children:"<prefix>.<table name>.deltastreamer.hiveSyncDuration"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,n.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},22429:(e,i,t)=>{t.d(i,{A:()=>r});const r=t.p+"assets/images/2020-05-28-datadog-metrics-demo-fff08d34cd7ef2473f16e9b48dd66793.png"},28453:(e,i,t)=>{t.d(i,{R:()=>a,x:()=>s});var r=t(96540);const o={},n=r.createContext(o);function a(e){const i=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(n.Provider,{value:i},e.children)}},95508:e=>{e.exports=JSON.parse('{"permalink":"/blog/2020/05/28/monitoring-hudi-metrics-with-datadog","editUrl":"https://github.com/apache/hudi/edit/asf-site/website/blog/blog/2020-05-28-monitoring-hudi-metrics-with-datadog.md","source":"@site/blog/2020-05-28-monitoring-hudi-metrics-with-datadog.md","title":"Monitor Hudi metrics with Datadog","description":"Availability","date":"2020-05-28T00:00:00.000Z","tags":[{"inline":true,"label":"how-to","permalink":"/blog/tags/how-to"},{"inline":true,"label":"metrics","permalink":"/blog/tags/metrics"},{"inline":true,"label":"apache hudi","permalink":"/blog/tags/apache-hudi"}],"readingTime":1.415,"hasTruncateMarker":true,"authors":[{"name":"rxu","key":null,"page":null}],"frontMatter":{"title":"Monitor Hudi metrics with Datadog","excerpt":"Introducing the feature of reporting Hudi metrics via Datadog HTTP API","author":"rxu","category":"blog","tags":["how-to","metrics","apache hudi"]},"unlisted":false,"prevItem":{"title":"The Apache Software Foundation Announces Apache\xae Hudi\u2122 as a Top-Level Project","permalink":"/blog/2020/06/04/The-Apache-Software-Foundation-Announces-Apache-Hudi-as-a-Top-Level-Project"},"nextItem":{"title":"Apache Hudi Support on Apache Zeppelin","permalink":"/blog/2020/04/27/apache-hudi-apache-zepplin"}}')}}]);