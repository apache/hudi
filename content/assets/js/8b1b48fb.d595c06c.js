"use strict";(self.webpackChunkhudi=self.webpackChunkhudi||[]).push([[73316],{54214:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"release-0.11.1","title":"Release 0.11.1","description":"Migration Guide","source":"@site/releases/release-0.11.1.md","sourceDirName":".","slug":"/release-0.11.1","permalink":"/releases/release-0.11.1","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"title":"Release 0.11.1","sidebar_position":12,"layout":"releases","toc":true,"last_modified_at":"2022-06-20T06:30:00.000Z"},"sidebar":"releases","previous":{"title":"Release 0.12.0","permalink":"/releases/release-0.12.0"},"next":{"title":"Release 0.11.0","permalink":"/releases/release-0.11.0"}}');var a=r(74848),t=r(28453);r(11470),r(19365);const i={title:"Release 0.11.1",sidebar_position:12,layout:"releases",toc:!0,last_modified_at:new Date("2022-06-20T06:30:00.000Z")},l="Release 0.11.1 (docs)",o={},c=[{value:"Migration Guide",id:"migration-guide",level:2},{value:"Release Highlights",id:"release-highlights",level:2},{value:"Addressing Performance Regression in 0.11.0",id:"addressing-performance-regression-in-0110",level:3},{value:"Key generator for Spark SQL",id:"key-generator-for-spark-sql",level:3},{value:"Query with Schema evolution",id:"query-with-schema-evolution",level:3},{value:"Bug fixes",id:"bug-fixes",level:3},{value:"Known Regressions",id:"known-regressions",level:2},{value:"Raw Release Notes",id:"raw-release-notes",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsxs)(n.h1,{id:"release-0111-docs",children:[(0,a.jsx)(n.a,{href:"https://github.com/apache/hudi/releases/tag/release-0.11.1",children:"Release 0.11.1"})," (",(0,a.jsx)(n.a,{href:"/docs/quick-start-guide",children:"docs"}),")"]})}),"\n",(0,a.jsx)(n.h2,{id:"migration-guide",children:"Migration Guide"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"This release (0.11.1) does not introduce any new table version, thus no migration is needed if you are on 0.11.0."}),"\n",(0,a.jsxs)(n.li,{children:["If migrating from an older release, please check the migration guide from the previous release notes, specifically\nthe upgrade instructions in ",(0,a.jsx)(n.a,{href:"/releases/release-0.6.0#migration-guide-for-this-release",children:"0.6.0"}),",\n",(0,a.jsx)(n.a,{href:"/releases/release-0.9.0#migration-guide-for-this-release",children:"0.9.0"}),", ",(0,a.jsx)(n.a,{href:"/releases/release-0.10.0#migration-guide",children:"0.10.0"}),", and\n",(0,a.jsx)(n.a,{href:"/releases/release-0.11.0#migration-guide",children:"0.11.0"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"release-highlights",children:"Release Highlights"}),"\n",(0,a.jsx)(n.h3,{id:"addressing-performance-regression-in-0110",children:"Addressing Performance Regression in 0.11.0"}),"\n",(0,a.jsx)(n.p,{children:"In 0.11.0 release, with the newly added support for Spark SQL features, the following performance regressions were\ninadvertently introduced:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Partition pruning for some of the COW tables is not applied properly"}),"\n",(0,a.jsx)(n.li,{children:"Spark SQL query caching (which caches parsed and resolved queries) was not working correctly resulting in additional"}),"\n",(0,a.jsx)(n.li,{children:"overhead to re-analyze the query every time when it's executed (listing the table contents, etc.)"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"All of these issues have been addressed in 0.11.1 and are validated to be resolved by benchmarking the set of changes\non TPC-DS against 0.10.1."}),"\n",(0,a.jsx)(n.h3,{id:"key-generator-for-spark-sql",children:"Key generator for Spark SQL"}),"\n",(0,a.jsx)(n.p,{children:"Prior to this release, Spark SQL uses a different default key generator compared with data source writers, which brings\nin confusion and errors.  In 0.11.1, Spark SQL now aligns with the data source to use the same logic for determining\nthe key generator."}),"\n",(0,a.jsx)(n.h3,{id:"query-with-schema-evolution",children:"Query with Schema evolution"}),"\n",(0,a.jsxs)(n.p,{children:["Due to necessary changes in addressing the performance regression in 0.11.0, when reading a Hudi table with Schema\nEvolution feature enabled, the query must have the config ",(0,a.jsx)(n.code,{children:"hoodie.schema.on.read.enable"})," to be explicitly set to ",(0,a.jsx)(n.code,{children:"true"}),"\nto ensure proper schema resolution and data reading."]}),"\n",(0,a.jsx)(n.h3,{id:"bug-fixes",children:"Bug fixes"}),"\n",(0,a.jsx)(n.p,{children:"0.11.1 release is mainly intended for bug fixes and stability. The fixes span across many components, including"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"DeltaStreamer"}),"\n",(0,a.jsx)(n.li,{children:"Table config"}),"\n",(0,a.jsx)(n.li,{children:"Table services"}),"\n",(0,a.jsx)(n.li,{children:"Metadata table"}),"\n",(0,a.jsx)(n.li,{children:"Spark SQL support"}),"\n",(0,a.jsx)(n.li,{children:"Spark, GCP bundles"}),"\n",(0,a.jsx)(n.li,{children:"Presto support"}),"\n",(0,a.jsx)(n.li,{children:"Hive Sync and Meta Sync"}),"\n",(0,a.jsx)(n.li,{children:"Flink engine"}),"\n",(0,a.jsx)(n.li,{children:"Unit, functional, integration tests and CI"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"known-regressions",children:"Known Regressions"}),"\n",(0,a.jsx)(n.p,{children:"We discovered a regression in Hudi 0.11.1 release related to metadata table and timeline server interplay with streaming ingestion pipelines."}),"\n",(0,a.jsx)(n.p,{children:"The FileSystemView that Hudi maintains internally could go out of sync due to a occasional race conditions when table services are involved\n(compaction, clustering) and could result in updates and deletes routed to older file versions and hence resulting in missed updates and deletes."}),"\n",(0,a.jsx)(n.p,{children:"Here are the user-flows that could potentially be impacted with this."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["This impacts pipelines using Deltastreamer in ",(0,a.jsx)(n.strong,{children:"continuous mode"})," (sync once is not impacted), Spark streaming, or if you have been directly\nusing write client across batches/commits instead of the standard ways to write to Hudi. In other words, batch writes should not be impacted."]}),"\n",(0,a.jsxs)(n.li,{children:["Among these write models, this could have an impact only when table services are enabled.","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"COW: clustering enabled (inline or async)"}),"\n",(0,a.jsx)(n.li,{children:"MOR: compaction enabled (by default, inline or async)"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"Also, the impact is applicable only when metadata table is enabled, and timeline server is enabled (which are defaults as of 0.12.1)"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Based on some production data, we expect this issue might impact roughly < 1% of updates to be missed, since its a race condition\nand table services are generally scheduled once every N commits. The percentage of update misses could be even less if the\nfrequency of table services is less."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://issues.apache.org/jira/browse/HUDI-5863",children:"Here"})," is the jira for the issue of interest and the fix has already been landed in master.\n0.12.3 should have the ",(0,a.jsx)(n.a,{href:"https://github.com/apache/hudi/pull/8079",children:"fix"}),". Until we have a 0.12.3 release, we recommend you to disable metadata table\n(",(0,a.jsx)(n.code,{children:"hoodie.metadata.enable=false"}),") to mitigate the issue."]}),"\n",(0,a.jsx)(n.p,{children:"Sorry about the inconvenience caused."}),"\n",(0,a.jsx)(n.h2,{id:"raw-release-notes",children:"Raw Release Notes"}),"\n",(0,a.jsxs)(n.p,{children:["The raw release notes are available ",(0,a.jsx)(n.a,{href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12351597",children:"here"})]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["0.11.1 release also contains all the new features and bug fixes from 0.11.0, of which the release notes are ",(0,a.jsx)(n.a,{href:"/releases/release-0.11.0",children:"here"})]})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},19365:(e,n,r)=>{r.d(n,{A:()=>i});r(96540);var s=r(34164);const a={tabItem:"tabItem_Ymn6"};var t=r(74848);function i(e){let{children:n,hidden:r,className:i}=e;return(0,t.jsx)("div",{role:"tabpanel",className:(0,s.A)(a.tabItem,i),hidden:r,children:n})}},11470:(e,n,r)=>{r.d(n,{A:()=>w});var s=r(96540),a=r(34164),t=r(23104),i=r(56347),l=r(205),o=r(57485),c=r(31682),d=r(70679);function u(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:r}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:r,attributes:s,default:a}}=e;return{value:n,label:r,attributes:s,default:a}}))}(r);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,r])}function p(e){let{value:n,tabValues:r}=e;return r.some((e=>e.value===n))}function f(e){let{queryString:n=!1,groupId:r}=e;const a=(0,i.W6)(),t=function(e){let{queryString:n=!1,groupId:r}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:n,groupId:r});return[(0,o.aZ)(t),(0,s.useCallback)((e=>{if(!t)return;const n=new URLSearchParams(a.location.search);n.set(t,e),a.replace({...a.location,search:n.toString()})}),[t,a])]}function m(e){const{defaultValue:n,queryString:r=!1,groupId:a}=e,t=h(e),[i,o]=(0,s.useState)((()=>function(e){let{defaultValue:n,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=r.find((e=>e.default))??r[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:t}))),[c,u]=f({queryString:r,groupId:a}),[m,g]=function(e){let{groupId:n}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(n),[a,t]=(0,d.Dv)(r);return[a,(0,s.useCallback)((e=>{r&&t.set(e)}),[r,t])]}({groupId:a}),b=(()=>{const e=c??m;return p({value:e,tabValues:t})?e:null})();(0,l.A)((()=>{b&&o(b)}),[b]);return{selectedValue:i,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:t}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),g(e)}),[u,g,t]),tabValues:t}}var g=r(92303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=r(74848);function x(e){let{className:n,block:r,selectedValue:s,selectValue:i,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,t.a_)(),d=e=>{const n=e.currentTarget,r=o.indexOf(n),a=l[r].value;a!==s&&(c(n),i(a))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const r=o.indexOf(e.currentTarget)+1;n=o[r]??o[0];break}case"ArrowLeft":{const r=o.indexOf(e.currentTarget)-1;n=o[r]??o[o.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":r},n),children:l.map((e=>{let{value:n,label:r,attributes:t}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>o.push(e),onKeyDown:u,onClick:d,...t,className:(0,a.A)("tabs__item",b.tabItem,t?.className,{"tabs__item--active":s===n}),children:r??n},n)}))})}function j(e){let{lazy:n,children:r,selectedValue:t}=e;const i=(Array.isArray(r)?r:[r]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===t));return e?(0,s.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function y(e){const n=m(e);return(0,v.jsxs)("div",{className:(0,a.A)("tabs-container",b.tabList),children:[(0,v.jsx)(x,{...n,...e}),(0,v.jsx)(j,{...n,...e})]})}function w(e){const n=(0,g.A)();return(0,v.jsx)(y,{...e,children:u(e.children)},String(n))}},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var s=r(96540);const a={},t=s.createContext(a);function i(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);