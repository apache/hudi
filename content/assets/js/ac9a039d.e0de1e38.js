"use strict";(self.webpackChunkhudi=self.webpackChunkhudi||[]).push([[12477],{29798:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"metadata","title":"Metadata Table","description":"Motivation for a Metadata Table","source":"@site/versioned_docs/version-0.10.0/metadata.md","sourceDirName":".","slug":"/metadata","permalink":"/docs/0.10.0/metadata","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/hudi/tree/asf-site/website/versioned_docs/version-0.10.0/metadata.md","tags":[],"version":"0.10.0","frontMatter":{"title":"Metadata Table","keywords":["hudi","metadata","S3 file listings"]},"sidebar":"docs","previous":{"title":"File Layouts","permalink":"/docs/0.10.0/file_layouts"},"next":{"title":"Write Operations","permalink":"/docs/0.10.0/write_operations"}}');var i=a(74848),o=a(28453);const s={title:"Metadata Table",keywords:["hudi","metadata","S3 file listings"]},r=void 0,l={},d=[{value:"Motivation for a Metadata Table",id:"motivation-for-a-metadata-table",level:2},{value:"Some numbers from a study:",id:"some-numbers-from-a-study",level:3},{value:"Enable Hudi Metadata Table",id:"enable-hudi-metadata-table",level:2},{value:"Deployment considerations",id:"deployment-considerations",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"motivation-for-a-metadata-table",children:"Motivation for a Metadata Table"}),"\n",(0,i.jsx)(t.p,{children:'The Apache Hudi Metadata Table can significantly improve read/write performance of your queries. The main purpose of the\nMetadata Table is to eliminate the requirement for the "list files" operation.'}),"\n",(0,i.jsx)(t.p,{children:"When reading and writing data, file listing operations are performed to get the current view of the file system.\nWhen data sets are large, listing all the files may be a performance bottleneck, but more importantly in the case of cloud storage systems\nlike AWS S3, the large number of file listing requests sometimes causes throttling due to certain request limits.\nThe Metadata Table will instead proactively maintain the list of files and remove the need for recursive file listing operations"}),"\n",(0,i.jsx)(t.h3,{id:"some-numbers-from-a-study",children:"Some numbers from a study:"}),"\n",(0,i.jsx)(t.p,{children:"Running a TPCDS benchmark the p50 list latencies for a single folder scales ~linearly with the amount of files/objects:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Number of files/objects"}),(0,i.jsx)(t.th,{children:"100"}),(0,i.jsx)(t.th,{children:"1K"}),(0,i.jsx)(t.th,{children:"10K"}),(0,i.jsx)(t.th,{children:"100K"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"P50 list latency"}),(0,i.jsx)(t.td,{children:"50ms"}),(0,i.jsx)(t.td,{children:"131ms"}),(0,i.jsx)(t.td,{children:"1062ms"}),(0,i.jsx)(t.td,{children:"9932ms"})]})})]}),"\n",(0,i.jsx)(t.p,{children:"Whereas listings from the Metadata Table will not scale linearly with file/object count and instead take about 100-500ms per read even for very large tables.\nEven better, the timeline server caches portions of the metadata (currently only for writers), and provides ~10ms performance for listings."}),"\n",(0,i.jsx)(t.h2,{id:"enable-hudi-metadata-table",children:"Enable Hudi Metadata Table"}),"\n",(0,i.jsx)(t.p,{children:"The Hudi Metadata Table is not enabled by default. If you wish to turn it on you need to enable the following configuration:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"/docs/configurations#hoodiemetadataenable",children:(0,i.jsx)(t.code,{children:"hoodie.metadata.enable"})})}),"\n",(0,i.jsx)(t.h2,{id:"deployment-considerations",children:"Deployment considerations"}),"\n",(0,i.jsx)(t.p,{children:"Once you turn on the Hudi Metadata Table, ensure that all write and read operations enable the configuration above to\nensure the Metadata Table stays up to date."}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["If your current deployment model is single writer along with async table services (such as cleaning, clustering, compaction)\nconfigured, then it is a must to have ",(0,i.jsx)(t.a,{href:"/docs/concurrency_control#enabling-multi-writing",children:"lock providers configured"}),"\nbefore turning on the metadata table."]})})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,t,a)=>{a.d(t,{R:()=>s,x:()=>r});var n=a(96540);const i={},o=n.createContext(i);function s(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);