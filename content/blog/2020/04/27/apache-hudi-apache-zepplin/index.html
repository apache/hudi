<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Apache Hudi Support on Apache Zeppelin | Apache Hudi</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hudi.apache.org/blog/2020/04/27/apache-hudi-apache-zepplin"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="apache hudi, data lake, lakehouse, big data, apache spark, apache flink, presto, trino, analytics, data engineering"><meta data-rh="true" property="og:title" content="Apache Hudi Support on Apache Zeppelin | Apache Hudi"><meta data-rh="true" name="description" content="1. Introduction"><meta data-rh="true" property="og:description" content="1. Introduction"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-04-27T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="how-to,apache zeppelin,apache hudi"><link data-rh="true" rel="icon" href="/assets/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://hudi.apache.org/blog/2020/04/27/apache-hudi-apache-zepplin"><link data-rh="true" rel="alternate" href="https://hudi.apache.org/blog/2020/04/27/apache-hudi-apache-zepplin" hreflang="en"><link data-rh="true" rel="alternate" href="https://hudi.apache.org/blog/2020/04/27/apache-hudi-apache-zepplin" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://hudi.apache.org/blog/2020/04/27/apache-hudi-apache-zepplin","mainEntityOfPage":"https://hudi.apache.org/blog/2020/04/27/apache-hudi-apache-zepplin","url":"https://hudi.apache.org/blog/2020/04/27/apache-hudi-apache-zepplin","headline":"Apache Hudi Support on Apache Zeppelin","name":"Apache Hudi Support on Apache Zeppelin","description":"1. Introduction","datePublished":"2020-04-27T00:00:00.000Z","author":{"@type":"Person","name":"leesf"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://hudi.apache.org/blog","name":"Blogs List Page"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Hudi: User-Facing Analytics RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Hudi: User-Facing Analytics Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Apache Hudi: User-Facing Analytics JSON Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Apache Hudi" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/videos/rss.xml" title="Apache Hudi RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/videos/atom.xml" title="Apache Hudi Atom Feed">





<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="9e4444ba-93cc-45ea-b143-783ae0fbeb6f" data-project-name="Apache Hudi" data-project-color="#FFFFFF" data-project-logo="/assets/images/logo-big.png" data-modal-disclaimer="This AI assistant answers Apache Hudi questions using your [documentation](https://hudi.apache.org/docs/quick-start-guide/), [dev setup](https://hudi.apache.org/contribute/developer-setup/), the [tech specs](https://hudi.apache.org/tech-specs-1point0/) and [open GitHub Issues](https://github.com/apache/hudi/issues/`) from the last year." data-modal-title="Apache Hudi AI Assistant" data-modal-example-questions-title="Try asking me..." data-modal-example-questions="How can I convert an existing COW table to MOR?,How do I set up incremental queries with Hudi tables?" data-modal-image="/assets/images/logo-small.png" data-modal-image-ask-ai="/assets/images/logo-small.png" data-modal-header-min-height="64px" data-modal-image-height="44" data-modal-image-width="64" data-modal-header-bg-color="#f8f9fa" data-modal-title-color="#15467D" data-button-text-color="#29557a" data-button-text="Ask AI" data-consent-required="true" data-consent-screen-title="Help us improve our AI assistant" data-consent-screen-disclaimer="By clicking &amp;quot;Allow tracking&amp;quot;, you consent to the use of the AI assistant in accordance with kapa.ai&#39;s [Privacy Policy](https://www.kapa.ai/content/privacy-policy). This service uses reCAPTCHA, which requires your consent to Google&#39;s [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms). By proceeding, you explicitly agree to both kapa.ai&#39;s and Google&#39;s privacy policies." data-consent-screen-accept-button-text="Allow tracking" data-modal-disclaimer-font-size="0.80rem" data-query-input-placeholder-text-color="#29557a" data-submit-query-button-bg-color="#228EDE" data-query-input-text-color="#29557a" data-user-analytics-cookie-enabled="false" data-query-input-border-color="#211b0e" data-question-text-color="#0db1f9" data-answer-text-color="#000" data-thread-clear-button-bg-color="#000000" data-thread-clear-button-text-color="#FFFFFF" data-answer-feedback-button-bg-color="#000000" data-answer-feedback-button-text-color="#FFFFFF" data-answer-feedback-button-active-bg-color="#000000" data-answer-feedback-button-active-text-color="#FFFFFF" data-answer-copy-button-bg-color="#000000" data-answer-copy-button-text-color="#FFFFFF" data-example-question-button-text-color="#29557a" data-modal-disclaimer-bg-color="#f8f9fa" data-modal-disclaimer-text-color="#15467D" data-deep-thinking-button-bg-color="#228EDE" data-deep-thinking-button-text-color="#FFFFFF" data-deep-thinking-button-active-bg-color="#0478C0" data-deep-thinking-button-hover-bg-color="#0478C0" data-deep-thinking-button-active-hover-bg-color="#0478C0" data-deep-thinking-button-active-text-color="#FFFFFF" async></script><link rel="stylesheet" href="/assets/css/styles.010b2389.css">
<script src="/assets/js/runtime~main.ebd71a89.js" defer="defer"></script>
<script src="/assets/js/main.d8caff94.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" role="banner"><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like <b>Apache Hudi</b>, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/apache/hudi"><b>GitHub!<svg xmlns="http://www.w3.org/2000/svg\" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 -2 16 16"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg></b></a> ⭐</div></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarWrapper_j_uY"><div class="navbar__inner navbarInnerStyle_KoMw"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo navbarLogo_aghy"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs/overview">Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/learn/tutorial-series">Tutorial Series</a></li><li><a class="dropdown__link" href="/learn/blog">Blogs</a></li><li><a class="dropdown__link" href="/learn/talks">Talks</a></li><li><a class="dropdown__link" href="/learn/videos">Video Guides</a></li><li><a class="dropdown__link" href="/learn/faq">FAQ</a></li><li><a class="dropdown__link" href="/learn/tech-specs">Tech Specs</a></li><li><a class="dropdown__link" href="/learn/tech-specs-1point0">Tech Specs 1.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Contribute</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contribute/developer-sync-call">Developer Sync Call</a></li><li><a class="dropdown__link" href="/contribute/how-to-contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/contribute/developer-setup">Developer Setup</a></li><li><a class="dropdown__link" href="/contribute/rfc-process">RFC Process</a></li><li><a class="dropdown__link" href="/contribute/security">Security</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/get-involved">Get Involved</a></li><li><a class="dropdown__link" href="/community/syncs">Community Syncs</a></li><li><a class="dropdown__link" href="/community/office_hours">Office Hours</a></li><li><a class="dropdown__link" href="/community/team">Team</a></li><li><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="dropdown__link">Github<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-33fabmxb7-Q7QSUtNOHYCwUdYM8LbauA" target="_blank" rel="noopener noreferrer" class="dropdown__link">Slack<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.linkedin.com/company/apache-hudi/" target="_blank" rel="noopener noreferrer" class="dropdown__link">LinkedIn<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.youtube.com/@apachehudi" target="_blank" rel="noopener noreferrer" class="dropdown__link">YouTube<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://x.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="dropdown__link">X<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Ecosystem</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/powered-by">Adopters</a></li><li><a class="dropdown__link" href="/roadmap">Roadmap</a></li><li><a class="dropdown__link" href="/ecosystem">Integrations</a></li></ul></div><a class="navbar__item navbar__link" href="/releases/download">Download</a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div><div role="button" class="searchButton_o6KI" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 14 14"><circle cx="6.864" cy="6.864" r="5.243" stroke="#15467D" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></circle><path stroke="#15467D" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m10.51 10.783 2.056 2.05"></path></svg></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar navbarSideMenu_TODO"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><div class="navbar__logo navbarLogo_aghy"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><button type="button" aria-label="Close navigation bar" class="clean-btn navbar-sidebar__close"><svg viewBox="0 0 15 15" width="21" height="21"><g stroke="var(--ifm-color-emphasis-600)" stroke-width="1.2"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><div class="navbar-sidebar__items"><div class="navbar-sidebar__item menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/docs/overview">Docs</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Learn</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Contribute</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Community</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Ecosystem</a></li><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/releases/download">Download</a></li></ul></div><div class="navbar-sidebar__item menu"><button type="button" class="clean-btn navbar-sidebar__back">← Back to main menu</button></div></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-2" itemscope="" itemtype="http://schema.org/Blog"><article class=""><header><h1 class="title_xvU1">Apache Hudi Support on Apache Zeppelin</h1><div class="container_iJTo margin-vert--sm"><time datetime="2020-04-27T00:00:00.000Z">April 27, 2020</time><div class="row"><div class="authorWrapper_ApDF col col--12 authorCol_q4o9">leesf</div></div><span class="marker_H0Am">3 min read</span></div><div class="row tagsListInline margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/how-to">how-to</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/apache-zeppelin">apache zeppelin</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/apache-hudi">apache hudi</a></li></ul></div></div></header><div id="__blog-post-container" class="markdown"><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-introduction">1. Introduction<a href="#1-introduction" class="hash-link" aria-label="Direct link to 1. Introduction" title="Direct link to 1. Introduction" translate="no">​</a></h2>
<p>Apache Zeppelin is a web-based notebook that provides interactive data analysis. It is convenient for you to make beautiful documents that can be data-driven, interactive, and collaborative, and supports multiple languages, including Scala (using Apache Spark), Python (Apache Spark), SparkSQL, Hive, Markdown, Shell, and so on. Hive and SparkSQL currently support querying Hudi’s read-optimized view and real-time view. So in theory, Zeppelin’s notebook should also have such query capabilities.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-achieve-the-effect">2. Achieve the effect<a href="#2-achieve-the-effect" class="hash-link" aria-label="Direct link to 2. Achieve the effect" title="Direct link to 2. Achieve the effect" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="21-hive">2.1 Hive<a href="#21-hive" class="hash-link" aria-label="Direct link to 2.1 Hive" title="Direct link to 2.1 Hive" translate="no">​</a></h3>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="211-read-optimized-view">2.1.1 Read optimized view<a href="#211-read-optimized-view" class="hash-link" aria-label="Direct link to 2.1.1 Read optimized view" title="Direct link to 2.1.1 Read optimized view" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Read Optimized View" src="/assets/images/read_optimized_view-f86557dfea584b97e869ec2d1aa9a46e.png" width="1845" height="950" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="212-real-time-view">2.1.2 Real-time view<a href="#212-real-time-view" class="hash-link" aria-label="Direct link to 2.1.2 Real-time view" title="Direct link to 2.1.2 Real-time view" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Real-time View" src="/assets/images/real_time_view-101973743bcb2dccb6e7cd4aa411aa73.png" width="1845" height="956" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="22-spark-sql">2.2 Spark SQL<a href="#22-spark-sql" class="hash-link" aria-label="Direct link to 2.2 Spark SQL" title="Direct link to 2.2 Spark SQL" translate="no">​</a></h3>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="221-read-optimized-view">2.2.1 Read optimized view<a href="#221-read-optimized-view" class="hash-link" aria-label="Direct link to 2.2.1 Read optimized view" title="Direct link to 2.2.1 Read optimized view" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Read Optimized View" src="/assets/images/spark_read_optimized_view-3aeb662ab165a9702e1d73ee495107ec.png" width="1833" height="449" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="222-real-time-view">2.2.2 Real-time view<a href="#222-real-time-view" class="hash-link" aria-label="Direct link to 2.2.2 Real-time view" title="Direct link to 2.2.2 Real-time view" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Real-time View" src="/assets/images/spark_real_time_view-1b76ee7a1e9e884439da562f46d95f57.png" width="1833" height="432" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-common-problems">3. Common problems<a href="#3-common-problems" class="hash-link" aria-label="Direct link to 3. Common problems" title="Direct link to 3. Common problems" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="31-hudi-package-adaptation">3.1 Hudi package adaptation<a href="#31-hudi-package-adaptation" class="hash-link" aria-label="Direct link to 3.1 Hudi package adaptation" title="Direct link to 3.1 Hudi package adaptation" translate="no">​</a></h3>
<p>Zeppelin will load the packages under lib by default when starting. For external dependencies such as Hudi, it is suitable to be placed directly under zeppelin / lib to avoid Hive or Spark SQL not finding the corresponding Hudi dependency on the cluster.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-parquet-jar-package-adaptation">3.2 Parquet jar package adaptation<a href="#32-parquet-jar-package-adaptation" class="hash-link" aria-label="Direct link to 3.2 Parquet jar package adaptation" title="Direct link to 3.2 Parquet jar package adaptation" translate="no">​</a></h3>
<p>The parquet version of the Hudi package is 1.10, and the current parquet version of the CDH cluster is 1.9, so when executing the Hudi table query, many jar package conflict errors will be reported.</p>
<p><strong>Solution</strong>: upgrade the parquet package to 1.10 in the spark / jars directory of the node where zepeelin is located.
<strong>Side effects</strong>: The tasks of saprk jobs other than zeppelin assigned to the cluster nodes of parquet 1.10 may fail.
<strong>Suggestions</strong>: Clients other than zeppelin will also have jar conflicts. Therefore, it is recommended to fully upgrade the spark jar, parquet jar and related dependent jars of the cluster to better adapt to Hudi’s capabilities.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="33-spark-interpreter-adaptation">3.3 Spark Interpreter adaptation<a href="#33-spark-interpreter-adaptation" class="hash-link" aria-label="Direct link to 3.3 Spark Interpreter adaptation" title="Direct link to 3.3 Spark Interpreter adaptation" translate="no">​</a></h3>
<p>The same SQL using Spark SQL query on Zeppelin will have more records than the hive query.</p>
<p><strong>Cause of the problem</strong>: When reading and writing Parquet tables to the Hive metastore, Spark SQL will use the Parquet SerDe (SerDe: Serialize / Deserilize for short) for Spark serialization and deserialization, not the Hive’s SerDe, because Spark SQL’s own SerDe has better performance.</p>
<p>This causes Spark SQL to only query Hudi’s pipeline records, not the final merge result.</p>
<p><strong>Solution</strong>: set <code>spark.sql.hive.convertMetastoreParquet=false</code></p>
<ol>
<li class=""><strong>Method 1</strong>: Edit properties directly on the page**
<img decoding="async" loading="lazy" src="data:image/png;base64,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ECBAgAABAgQIECBAgAABAgQInCWg0HgWn8YECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEHlNAofEx192sCRAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECJwloNB4Fp/GBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBB5TQKHxMdfdrAkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAicJaDQeBafxgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQeU0Ch8THX3awJECBAgAABAgQIECBAgAABAgQIECBAgAABAgQInCWg0HgWn8YECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEHlNAofEx192sCRAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECJwlcFKh8e3bt40vBmJADIgBMSAGxIAYEANiQAyIATEgBsSAGBADYkAMiAExIAbEgBgQA2LgcWPgpELjWaVNjQkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQ+OwFFBo/+yU0AQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQKvL6DQ+PrmrkiAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEDgsxeYLzT+7W9N86c/+WIgBsSAGBADYkAMiAExIAbEgBgQA2JADIgBMXCbMRD+/8qLAAECBAgQIEDgagLzhcbwBvqLL3wxEANiQAyIATEgBsSAGBADYkAMiAExIAbEgBi4zRgI/3/lRYAAAQIECBAgcDWBg4XG//3xj7f5F2v+ktC6iAExIAbEgBgQA2JADIgBMSAGxIAYEANi4CFjIP5/VSj+hvX3IkCAAAECBAgQuJrAwUKjN2xXWxsXJkCAAAECBAgQIECAAAECBAgQmBIIBUaFxikZ+wgQIECAAAECryqg0Piq3C5GgAABAgQIECBAgAABAgQIECBwtoBC49mEOiBAgAABAgQIvITAxQqNnz59at6/f9/s9/vmxx9/9MVADIgBMSAGxIAYEANiQAyIATEgBl41BkI+GvLSkJ96XU5A/u//PM79f5+TflcVGi/3S61nAgQIECBAgMARAhcpNIYk46effmrevXvX/P7770cMx6kECBAgQIAAAQIECBAgQOBlBEI+GvLSkJ8qNr6Mad2L/L8W8fMpAif9rio0nkKtDQECBAgQIEDgxQUuUmgMfzEakjkvAgQIECBAgAABAgQIECBwbQE56uVWgO3lbB+x56PiSaHxEUPEnAkQIECAAIEbFLhIoTE88sKdjDe42oZEgAABAgQIECBAgACBBxQI+WnIU71eXkD+//Kmj9zjUb+rCo2PHCrmToAAAQIECNyQwEUKjeHZ/F4ECBAgQIAAAQIECBAgQOBWBOSpl1kJrpdxfeReV8eUQuMjh4m5EyBAgAABAjckoNB4Q4thKAQIECBAgAABAgQIECBwGYHVxYvLXP5ue+V6t0t7tYmtjimFxqutkQsTIECAAAECBHIBhcZcwzYBAgQIECBAgAABAgQI3KXA6uLFXc7+cpPiejnbR+15dUwpND5qiJg3AQIECBAgcGMCCo03tiCGQ4AAAQIECBAgQIAAAQIvL7C6ePHyl77rHrne9fJeZXKrY0qh8Srr46IECBAgQIAAgVpAobEW8TMBAgQIECBAgAABAgQI3J3A6uLFwsw/fvzYvHnzpgl9HfMV2oS29/h6Cdd7dDGn0wVWx5RC4+nIWhIgQIAAAQIEXlBAofEFMXVFgAABAgQIECBAgAABArcpsLp4sTD8UDD88OHDwhnTh0Kb0PYeXy/heo8u5nS6wOqYUmg8HVlLAgQIECBAgMALCig0viCmrggQIECAAAECBAgQIEDgNgVWFy8Whn9OH+e0XRjS1Q/d67yuDvvAA1gdUwqNDxwlpk6AAAECBC4v8OWXXzbhy+uwwMMVGp93m+Zpuz8sc+IZ8/3vm+3Tptk9z3T8vGs2S8dnmt3l7v22eXp6auaXKVg+XXQdr+bazT3MP33NO1xtlC5MgAABAgQIECBA4LMTWF28WJjZOX2c3va52W3a/GAzm1C2g57PRxcmdeah0+c1ceGQD212zVzaPNFi1a4ll6Vjqzp30osLrI4phcYXt9chAQIECBAgMAgoNA4Wh7YUGg8JHXl8Pkk5UGg88jr3dPp++9QUCXNMLjfNZibBjMbHFBpjEXfbnFtenl/bF1yNOrGOY18qur7gtY/s6lU8jhyT0wkQIECAAAECBAjMCawuXsx10DTxcxkXDi8eOvX6x7zvPubcxcEecfDUeU1eos6HJk86fueSy9Kx46/0WC32+33z/DxfFg7HwjnHvlbHlELjsbTOJ0CAAAECBI4QUGhcj6XQuN5q1ZnzSYpC4xzgbKFx8g7P1nG7PeLO1M+50Ng0TYipohA7B/nK++dj/ZUH4nIECBAgQIAAAQIEVgisLl4s9HVOH6e2HeVLC+O7xnv0U+c1OQ2FxkmWW90Zioj/+Mc/ZocXjik0zvI4QIAAAQIECNy4gELj+gW6mUJjTIj6x0Wmu8/aR8Rs98OjYsaP1Oweo5naZnfBtUnWrnvMTPvY0jLx6vrN2vR03Z1k48dXlmPZ7HbFI1HL/vvemqbpCo378IjU9FjMNM9w3lCInEoky33lnBeLUCFR66+X3RlX7S8fJ7s01rQm+dyqfUXf+eNiu3533Zi2/9c/AqgdY3dul1zupx5zG45t97H4Vo65XJf+WDGW7HGr1f7CcGLtg/+kY1y3/Fi+pp3LrlvzPs5mxhrDYPyooGHtq3ZP+bVq2+6vRot5bptdbjpRgB3H73SszXvkcWGbAAECBAgQIECAwO0IvERB7Jw+jm9bv/9PuVX5Hj1/1Gj9fr54397nI2FNyj6KfOjIJTt+Xu0FirGl3CbkL5tdE3PBlMfWnyVR5DjJJA26MuvmXLp051TH4jkz1yyOPeVP5GkdhyF2fQ870sDu9vtcMfFQEXIJZHVMuaNxidExAgQIECBA4EwBhcb1gLdRaKwLHvt995jLlCRkyUM8N/t5v80+y698k98mA9m53d1hbRFqKQFojw25wb5pn/bR7s+TsDY5Gq5RJjD5QnSJXJ/c1dcPx7t+uuSqfwBJ4VPOMS9Q5leL2zEBy4pRz7tmF+pPcf8w5qap57U81tEc8/HW18yPpWR2gO2GmSdq3fiiU2YSzxzWpRxDPf7hvLZZKPRlDvES2c/FmKu2TVr79s7CvoDZjjx+VmQeD3Fc9Rr3P4dGB8ZaeMWAHT6783nXbPvPZKn76dYsty3mlfrKiq1FXMUJVQXc5Vgr16Bt718CBAgQIECAAAECtyqwunixMIFz+ji1bcg585wj5HPD2/7yPXvxHr3KLZ7DYy7j3Mo2iznlgkU6dMq8Yh49TKJ53u3a/wOIOUw235iz1H8wW+Vyfb5V50hNs9+1n/c4uLTn5HldPFYUD8t+2uPZNbu8th9+nldV5snonr+Hx6P+/e9/b3755Zd+mmE77Ft6rGp/8sTG6phSaJzQs4sAAQIECBA4VSAVFtP3P/zhD034Sj+n76f2f8/tbqjQmBe+Enn7Br9/A9/tHiVa6fRYQBqSkiGZGE5I++rEZjgjbJWJRX8sTyD6nSFJG8ae+u8P9xvleXF3kYTkx/PtqsBVtGk7D9csEs+4e9ouHJr0K/otrz8aa+WQ95dvd6NrdpvkM9Hv1HiysRT9ZfsL52o8/XhT4EwdbwfX/ZuPa2btY52uelxrNp6hu3FfaRjxnKmxhH7SSWE7/RVt/J7shiukrcIgJrvluYVd16hoMzGW4vjE/MLxFGvFuWlQvhMgQIAAAQIECBC4UYHVxYuF8Z/Tx6ltp97X50PMjxfv0WNukRfIulYH3ufnfa/ZPnpeE3lIf52JseXzy7fbNiF/6/Kgibap3+QS2ve5V3cwHUvnxu99X9N5dd2mHVf5tKOivzv/4d27d7Gw+OnTpyZ8hSJj2Hfqa3VMKTSeSqwdAQIECBAgMCGQConpu0LjBNLMrtsoNIbBxWSjfQRlqrmkgt/wczuL8KY+FTvSOXlxJh2r3/y3l9m0hZz+rx5nZLpiY+w3DaBPNvI2eWGpKgrmp00UguKdhf04xv2088gSp1TsKgpR3WM70xj7a5b99bu7eY1OL5K9ibbV3EMi1fYRzk3Ja5uE5WuRtodzy2JYGNcoWcyvlY0rP69Y23D+lEmyzfroHbJ4a9vm48rmkUEV10xrkR1v+84T0Xy7u/KhseZz7wc7bASDYq799es1m7h2PeYJl3yOcXvKtbtmfu4wQlsECBAgQIAAAQIEblNgdfFiYfjn9HFq2zwPaoeW5Svd+/XZHLjPP4Z859D7/IXpTx46el5LOc/EsWH+43mn3CikKEv5ST/nlCNmM5lsF3KleG6dZ3UNR+MM5w1/9Jx1/zCb//73v5t//vOf8Stsn/NaHVMKjecwa0uAAAECBAgcEEgFxwOnOdw0ze0UGvvlaN+gt7WM6WJJnWj0tZaqaDWVMKR9sWAzkWT0w8g24rlt5jJ6BGdbIK2StnxAfT8TCUqRnFTHU2KTvqd+QpvJ/tMJ6fu0XTg6+KVzu0Jv71GNpW0UPyujf5xrGkf63nUV+p4f3kS/U+MpXNrxbuPnHKaCZpVE1kbZtOJmON4XQ7u55j9PFYGz+STvFDt999U42/3BPcXDxBocGutkn23P9bqV4xnb1ueHXsK+NJ82dgfTcLzos1rbdhTDv8W5w25bBAgQIECAAAECBG5SYHXxYmH05/Rxatvyff04x8iPz75HjzlRl6cceJ+/MP3JQ0fPq87P8l4n8qF8fmF7Nt+caJu6Ti6hff6ZluF4OpbOjd/7vsbe/fFsIKGPzXZb5p1Fh/f/Q7iTMXxeY/gK2+e8VseUQuM5zNoSIECAAAECBwQUGg8AZYdvo9BYfMZE/ka+3S4SgfCGvy8S1cWV8PPwV4RTCUO+r0gy8sQrFJ6qpKEtzpT9B8fYx9yjUxfHGhtnSU49lzD3TbPd5ndvxivGOWbDG5azmEOXMPVWbYFt/Wc0pmJZ132faKXLhfFum22d6BVzTuem7/Uc2/3BMP0FbtxTXyv2WZ6Tr2O6q7XoI10yfK8T2cn+03zn1n4qAR3HQxxXX7DNYzkNqN03O9Z6bKnZ6E7U7nejD4SxbRxLtf6b8BfPRZssUY9OC8f7sbQb5RpUB/1IgAABAgQIECBA4MYEVhcvFsZ9Th+nti3zpfp9f5mT5O/Rn3fbpv+I9+KPK9s2fVqwMN81h46fV53LhFwr+4zGPp9qr17MP+aG5R9LDmMsLcL+8Wc0djl8do02b0r5YGxV5NyjvCpaZnlUlsPl/sO4Hmfr119/bcLXua/VMaXQeC619gQIECBAgMCCgELjAk516DYKjanAUT32JRWQ2rvZ0iMj8wQgFdPSsbbwlYo4U2/yy31dghMKhb+Eu95S32l/12+WhDRdUjE8oqVM9Ir+iySoPC+uQ5aQtP2m67erFPvKC0Vp8SqvpzTuuH+qj+STHYtjS/vLIt7UWMrHvLYDiUXWwiYf99D3UCieMAhN+vl04ytc4gnZXYLZNYrMuE0q07qE7/nhONa+yFat73abfc5mdayY33CNoe9hX7x2cX7b13BuO/Y6hoqxjuae2nSF6e53JKx5KEKXRcNsfbtmbQwNcbzf5W2qPje7ZnS8X5u0nvk1hrmP55iN2yYBAgQIECBAgACBGxBYXbxYGOs5fZzatii0pTvw+rxgIQeucr7iPfvi+/wFgIlDp81rJu+ayIeW51/foTjkKDE/6yZd5On9x6S0uU17bNfsNinnqfPj+v8dslyzcxxsu3kNOybE7DoksDqmFBoPUTpOgAABAgQInCGg0Lge7zYKjbPjnSvUzDa4woGQyOTFlysMwSUJrBQoE+yVjZxGgAABAgQIECBA4A4EVhcvFuZ6Th/ntF0Y0tUP3eu8rg77wANYHVMKjQ8cJaZOgAABAgQuL6DQuN5YoXG91cyZCo0zMHbfoIBC4w0uiiERIECAAAECBAi8isDq4sXCaN68edN8+PBh4YzpQ6FNaHuPr5dwvUcXczpdYHVMKTSejqwlAQIECBAgQOAFBRQaz8ZUaDybUAevJqDQ+GrULkSAAAECBAgQIHBjAquLFwvj/vjxYywYhr6O+QpFxtD2Hl8v4XqPLuZ0usDqmFJoPB1ZSwIECBAgQIDACwrceKHxBWeqKwIECBAgQIAAAQIECBB4WIHVxYuHFTpt4lxPc9NqXmB1TCk0ziM6QoAAAQIECBB4RQGFxlfEdikCBAgQIECAAAECBAgQuI7A6uLFdYb32V6V62e7dDc78NUxpdB4s2toYAQIECBAgMBjCSg0PtZ6my0BAgQIECBAgAABAgQeUmB18eIhdU6fNNfT7bScFlgdUwqN04D2EiBAgAABAgReWUCh8ZXBXY4AAQIECBAgQIAAAQIEXl9gdfHi9Yf2WV+R62e9fDc5+NUxpdB4k+tnUAQIECBAgMDjCVyk0Ljf75vff//98TTNmAABAgQIECBAgAABAgRuTiDkpyFP9Xp5Afn/y5s+co9H/a4qND5yqJg7AQIECBAgcEMCFyk0vn//vnn37t0NTdNQCBAgQIAAAQIECBAgQOBRBeSol1t5tpezfcSej4onhcZHDBFzJkCAAAECBG5Q4CKFxk+fPjU//fRTE94gurPxBlfdkAgQIECAAAECBAgQIPAAAiEfDXlpyE9Dnur18gLy/5c3fcQeT/pdVWh8xFAxZwIECBAgQOAGBS5SaAzzDMlGuKsxPEYlPF/fFwMxIAbEgBgQA2JADIgBMSAGxIAYeM0YCPloyEsVGS/7vxHyf7/X5/5en/S7qtB42V9svRMgQIAAAQIEVgpcrNC48vpOI0CAAAECBAgQIECAAAECBAgQIHCcgELjcV7OJkCAAAECBAhcSOBgofF/f/xj04Q3b74YiAExIAbEgBgQA2JADIgBMSAGxIAYEANiQAzcQAzE/6/64ot2LS70n2a6JUCAAAECBAgQOCxwsNDYhDdtvhiIATEgBsSAGBADYkAMiAExIAbEgBgQA2JADNxaDISipxcBAgQIECBAgMDVBOYLjX/7m7/Qu4G/0HMnqbtpxYAYEANiQAyIATEgBsSAGBADYkAMiAExMBMD4f+vvAgQIECAAAECBK4mMF9ovNqQXJgAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgVsXGBUa371713z69OnWx218BAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAhcUWBUaPz111+b8OVFgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBOYFRofG///1v8/79+1hsdGfjHJv9BAgQIECAAGbB6jIAAAQ5SURBVAECBAgQIECAAAECBAgQIECAAAECBB5bYFRoDByh2BjuagyPUX379q0vBmJADIgBMSAGxIAYEANiQAyIATEgBsSAGBADYkAMiAExIAbEgBgQA2JADBQxMFlofOzaq9kTIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIHBIQKHxkJDjBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAiMBBQaRyR2ECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBwSECh8ZCQ4wQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIjAQUGkckdhAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgcEhAofGQkOMECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECIwEFBpHJHYQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIHBIQKHxkJDjBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAiMBBQaRyR2ECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBwSECh8ZCQ4wQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIjAQUGkckdhAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgcEhAofGQkOMECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECIwEFBpHJHYQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIHBIQKHxkJDjBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAiMBBQaRyR2ECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBwSECh8ZCQ4wQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIjAQUGkckdhAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgcEhAofGQkOMECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECIwEFBpHJHYQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIHBIQKHxkJDjBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAiMBBQaRyR2ECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBwSECh8ZCQ4wQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIjAQUGkckdhAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgcEhAofGQkOMECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECIwEFBpHJHYQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIHBIQKHxkJDjBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAiMBBQaRyR2ECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBwSOD/AYYuAvdRX99hAAAAAElFTkSuQmCC" width="1818" height="105" class="img_ev3q"></li>
<li class=""><strong>Method 2</strong>: Edit <code>zeppelin / conf / interpreter.json</code> and add**</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token property">&quot;spark.sql.hive.convertMetastoreParquet&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;spark.sql.hive.convertMetastoreParquet&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;checkbox&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-hudi-incremental-view">4. Hudi incremental view<a href="#4-hudi-incremental-view" class="hash-link" aria-label="Direct link to 4. Hudi incremental view" title="Direct link to 4. Hudi incremental view" translate="no">​</a></h2>
<p>For Hudi incremental view, currently only supports pulling by writing Spark code. Considering that Zeppelin has the ability to execute code and shell commands directly on the notebook, later consider packaging these notebooks to query Hudi incremental views in a way that supports SQL.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/apache/hudi/edit/asf-site/website/blog/blog/2020-04-27-apache-hudi-apache-zepplin.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2020/05/28/monitoring-hudi-metrics-with-datadog"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Monitor Hudi metrics with Datadog</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2020/03/22/exporting-hudi-datasets"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Export Hudi datasets as a copy or as different formats</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-introduction" class="table-of-contents__link toc-highlight">1. Introduction</a></li><li><a href="#2-achieve-the-effect" class="table-of-contents__link toc-highlight">2. Achieve the effect</a><ul><li><a href="#21-hive" class="table-of-contents__link toc-highlight">2.1 Hive</a></li><li><a href="#211-read-optimized-view" class="table-of-contents__link toc-highlight">2.1.1 Read optimized view</a></li><li><a href="#212-real-time-view" class="table-of-contents__link toc-highlight">2.1.2 Real-time view</a></li><li><a href="#22-spark-sql" class="table-of-contents__link toc-highlight">2.2 Spark SQL</a></li><li><a href="#221-read-optimized-view" class="table-of-contents__link toc-highlight">2.2.1 Read optimized view</a></li><li><a href="#222-real-time-view" class="table-of-contents__link toc-highlight">2.2.2 Real-time view</a></li></ul></li><li><a href="#3-common-problems" class="table-of-contents__link toc-highlight">3. Common problems</a><ul><li><a href="#31-hudi-package-adaptation" class="table-of-contents__link toc-highlight">3.1 Hudi package adaptation</a></li><li><a href="#32-parquet-jar-package-adaptation" class="table-of-contents__link toc-highlight">3.2 Parquet jar package adaptation</a></li><li><a href="#33-spark-interpreter-adaptation" class="table-of-contents__link toc-highlight">3.3 Spark Interpreter adaptation</a></li></ul></li><li><a href="#4-hudi-incremental-view" class="table-of-contents__link toc-highlight">4. Hudi incremental view</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footerCustom_j_zv"><div class="container container-fluid container_y1z5"><div class="brand_kMBW"><a href="https://hudi.apache.org/" rel="noopener noreferrer" class="footerLogoLink_DDai"><img src="/assets/images/hudi.png" alt="Apache Hudi™" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/hudi.png" alt="Apache Hudi™" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="links_AXCu"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">About</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/2021/07/21/streaming-data-lake-platform">Our Vision</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/community/team">Team</a></li><li class="footer__item"><a class="footer__link-item" href="/releases/release-1.1.0">Releases</a></li><li class="footer__item"><a class="footer__link-item" href="/releases/download">Download</a></li><li class="footer__item"><a class="footer__link-item" href="/powered-by">Adopters</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quick-start-guide">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/tutorial-series">Tutorial Series</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/talks">Talks</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/videos">Video Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/faq">FAQ</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Hudi On Cloud</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/s3_hoodie">AWS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/gcs_hoodie">Google Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/oss_hoodie">Alibaba Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/azure_hoodie">Microsoft Azure</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cos_hoodie">Tencent Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/ibm_cos_hoodie">IBM Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/oci_hoodie">Oracle Cloud</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community/get-involved">Get Involved</a></li><li class="footer__item"><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-33fabmxb7-Q7QSUtNOHYCwUdYM8LbauA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCs7AhE0BWaEPZSChrBR-Muw" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/apache-hudi/?viewAsMember=true" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:dev-subscribe@hudi.apache.org?Subject=SubscribeToHudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Apache</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li><li class="footer__item"><a href="https://www.apache.org/licenses" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a class="footer__link-item" href="/asf/privacy">Privacy</a></li><li class="footer__item"><a class="footer__link-item" href="/asf/telemetry">Telemetry</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li></ul></div></div></div><div class="legal_MFbX"><div class="footer__copyright">Copyright © 2021 <a href="https://apache.org">The Apache Software Foundation</a>, Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0"> Apache License, Version 2.0</a>. Hudi, Apache and the Apache feather logo are trademarks of The Apache Software Foundation.<img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=8f594acf-9b77-44fb-9475-3e82ead1910c"><img referrerpolicy="no-referrer-when-downgrade" src="https://analytics.apache.org/matomo.php?idsite=47&amp;rec=1"></div></div></div></footer></div>
</body>
</html>