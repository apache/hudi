<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Modernizing Data Infrastructure at Peloton Using Apache Hudi | Apache Hudi</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hudi.apache.org/blog/2025/07/15/modernizing-datainfra-peloton-hudi"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="cn"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="apache hudi, data lake, lakehouse, big data, apache spark, apache flink, presto, trino, analytics, data engineering"><meta data-rh="true" property="og:title" content="Modernizing Data Infrastructure at Peloton Using Apache Hudi | Apache Hudi"><meta data-rh="true" name="description" content="Peloton re-architected its data platform using Apache Hudi to overcome snapshot delays, rigid service coupling, and high operational costs. By adopting CDC-based ingestion from PostgreSQL and DynamoDB, moving from CoW to MoR tables, and leveraging asynchronous services with fine-grained schema control, Peloton achieved 10-minute ingestion cycles, reduced compute/storage overhead, and enabled time travel and GDPR compliance."><meta data-rh="true" property="og:description" content="Peloton re-architected its data platform using Apache Hudi to overcome snapshot delays, rigid service coupling, and high operational costs. By adopting CDC-based ingestion from PostgreSQL and DynamoDB, moving from CoW to MoR tables, and leveraging asynchronous services with fine-grained schema control, Peloton achieved 10-minute ingestion cycles, reduced compute/storage overhead, and enabled time travel and GDPR compliance."><meta data-rh="true" property="og:image" content="https://hudi.apache.org/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/peloton-1200x600.jpg"><meta data-rh="true" name="twitter:image" content="https://hudi.apache.org/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/peloton-1200x600.jpg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-07-15T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="Apache Hudi,Peloton,Community"><link data-rh="true" rel="icon" href="/assets/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://hudi.apache.org/blog/2025/07/15/modernizing-datainfra-peloton-hudi"><link data-rh="true" rel="alternate" href="https://hudi.apache.org/blog/2025/07/15/modernizing-datainfra-peloton-hudi" hreflang="en"><link data-rh="true" rel="alternate" href="https://hudi.apache.org/cn/blog/2025/07/15/modernizing-datainfra-peloton-hudi" hreflang="cn"><link data-rh="true" rel="alternate" href="https://hudi.apache.org/blog/2025/07/15/modernizing-datainfra-peloton-hudi" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://hudi.apache.org/blog/2025/07/15/modernizing-datainfra-peloton-hudi","mainEntityOfPage":"https://hudi.apache.org/blog/2025/07/15/modernizing-datainfra-peloton-hudi","url":"https://hudi.apache.org/blog/2025/07/15/modernizing-datainfra-peloton-hudi","headline":"Modernizing Data Infrastructure at Peloton Using Apache Hudi","name":"Modernizing Data Infrastructure at Peloton Using Apache Hudi","description":"Peloton re-architected its data platform using Apache Hudi to overcome snapshot delays, rigid service coupling, and high operational costs. By adopting CDC-based ingestion from PostgreSQL and DynamoDB, moving from CoW to MoR tables, and leveraging asynchronous services with fine-grained schema control, Peloton achieved 10-minute ingestion cycles, reduced compute/storage overhead, and enabled time travel and GDPR compliance.","datePublished":"2025-07-15T00:00:00.000Z","author":{"@type":"Person","name":"Amaresh Bingumalla, Thinh Kenny Vu, Gabriel Wang, Arun Vasudevan in collaboration with Dipankar Mazumdar"},"image":{"@type":"ImageObject","@id":"https://hudi.apache.org/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/peloton-1200x600.jpg","url":"https://hudi.apache.org/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/peloton-1200x600.jpg","contentUrl":"https://hudi.apache.org/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/peloton-1200x600.jpg","caption":"title image for the blog post: Modernizing Data Infrastructure at Peloton Using Apache Hudi"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://hudi.apache.org/blog","name":"Blogs List Page"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Hudi: User-Facing Analytics RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Hudi: User-Facing Analytics Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Apache Hudi: User-Facing Analytics JSON Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Apache Hudi" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/videos/rss.xml" title="Apache Hudi RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/videos/atom.xml" title="Apache Hudi Atom Feed">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Comfortaa|Ubuntu|Roboto|Source+Code+Pro">
<link rel="stylesheet" href="https://at-ui.github.io/feather-font/css/iconfont.css"><link rel="stylesheet" href="/assets/css/styles.d44ac021.css">
<script src="/assets/js/runtime~main.01fef3f7.js" defer="defer"></script>
<script src="/assets/js/main.9acef0d1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" role="banner"><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like <b>Apache Hudi</b>, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/apache/hudi"><b>GitHub!<svg xmlns="http://www.w3.org/2000/svg\" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 -2 16 16"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg></b></a> ⭐</div></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarWrapper_j_uY"><div class="navbar__inner navbarInnerStyle_KoMw"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo navbarLogo_aghy"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs/overview">Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/learn/tutorial-series">Tutorial Series</a></li><li><a class="dropdown__link" href="/talks">Talks</a></li><li><a class="dropdown__link" href="/videos">Video Guides</a></li><li><a class="dropdown__link" href="/docs/faq">FAQ</a></li><li><a class="dropdown__link" href="/tech-specs">Tech Specs</a></li><li><a class="dropdown__link" href="/tech-specs-1point0">Tech Specs 1.0</a></li><li><a href="https://cwiki.apache.org/confluence/display/HUDI" target="_blank" rel="noopener noreferrer" class="dropdown__link">Technical Wiki<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Contribute</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contribute/developer-sync-call">Developer Sync Call</a></li><li><a class="dropdown__link" href="/contribute/how-to-contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/contribute/developer-setup">Developer Setup</a></li><li><a class="dropdown__link" href="/contribute/rfc-process">RFC Process</a></li><li><a class="dropdown__link" href="/contribute/report-security-issues">Report Security Issues</a></li><li><a href="https://issues.apache.org/jira/projects/HUDI/summary" target="_blank" rel="noopener noreferrer" class="dropdown__link">Report Issues<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/get-involved">Get Involved</a></li><li><a class="dropdown__link" href="/community/syncs">Community Syncs</a></li><li><a class="dropdown__link" href="/community/office_hours">Office Hours</a></li><li><a class="dropdown__link" href="/community/team">Team</a></li><li><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-33fabmxb7-Q7QSUtNOHYCwUdYM8LbauA" target="_blank" rel="noopener noreferrer" class="dropdown__link">Join Our Slack Space<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><a class="navbar__item navbar__link" href="/ecosystem">Ecosystem</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/powered-by">Who&#x27;s Using</a><a class="navbar__item navbar__link" href="/roadmap">Roadmap</a><a class="navbar__item navbar__link" href="/releases/download">Download</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/overview">1.0.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/overview">Current</a></li><li><a class="dropdown__link" href="/docs/overview">1.0.2</a></li><li><a class="dropdown__link" href="/docs/1.0.1/overview">1.0.1</a></li><li><a class="dropdown__link" href="/docs/1.0.0/overview">1.0.0</a></li><li><a class="dropdown__link" href="/docs/0.15.0/overview">0.15.0</a></li><li><a class="dropdown__link" href="/docs/0.14.1/overview">0.14.1</a></li><li><a class="dropdown__link" href="/docs/0.14.0/overview">0.14.0</a></li><li><a class="dropdown__link" href="/docs/0.13.1/overview">0.13.1</a></li><li><a class="dropdown__link" href="/docs/0.13.0/overview">0.13.0</a></li><li><a class="dropdown__link" href="/docs/0.12.3/overview">0.12.3</a></li><li><a class="dropdown__link" href="/docs/0.12.2/overview">0.12.2</a></li><li><a class="dropdown__link" href="/docs/0.12.1/overview">0.12.1</a></li><li><a class="dropdown__link" href="/docs/0.12.0/overview">0.12.0</a></li><li><a class="dropdown__link" href="/docs/0.11.1/overview">0.11.1</a></li><li><a class="dropdown__link" href="/docs/0.11.0/overview">0.11.0</a></li><li><a class="dropdown__link" href="/docs/0.10.1/overview">0.10.1</a></li><li><a class="dropdown__link" href="/docs/0.10.0/overview">0.10.0</a></li><li><a class="dropdown__link" href="/docs/0.9.0/overview">0.9.0</a></li><li><a class="dropdown__link" href="/docs/0.8.0/overview">0.8.0</a></li><li><a class="dropdown__link" href="/docs/0.7.0/overview">0.7.0</a></li><li><a class="dropdown__link" href="/docs/0.6.0/quick-start-guide">0.6.0</a></li><li><a class="dropdown__link" href="/docs/0.5.3/quick-start-guide">0.5.3</a></li><li><a class="dropdown__link" href="/docs/0.5.2/quick-start-guide">0.5.2</a></li><li><a class="dropdown__link" href="/docs/0.5.1/quick-start-guide">0.5.1</a></li><li><a class="dropdown__link" href="/docs/0.5.0/quick-start-guide">0.5.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link locale-dropdown-wrapper"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 14 14" class="globeIcon_RxQM"><g clip-path="url(#a)"><path fill="#1C1E21" d="M14 6.457a6.84 6.84 0 0 0-7-6.02 6.843 6.843 0 0 0-7 6.02v1.085a6.843 6.843 0 0 0 7 6.02 6.843 6.843 0 0 0 7-6.02zm-1.094 0h-2.625a10 10 0 0 0-.376-2.222 6.7 6.7 0 0 0 1.531-.875 5.25 5.25 0 0 1 1.444 3.097zm-8.032 0a8.5 8.5 0 0 1 .324-1.872 7.4 7.4 0 0 0 3.63 0c.175.61.284 1.239.325 1.872zm4.305 1.085a8.4 8.4 0 0 1-.324 1.873 7.46 7.46 0 0 0-3.658 0 8.5 8.5 0 0 1-.323-1.873zm.35-4.375A10.3 10.3 0 0 0 8.75 1.75c.627.194 1.218.49 1.75.875a5.8 5.8 0 0 1-.998.577zM7.254 1.54A8.8 8.8 0 0 1 8.46 3.552c-.48.11-.97.165-1.461.167-.492-.001-.982-.057-1.461-.167.308-.722.715-1.4 1.207-2.012zM4.498 3.202a5.8 5.8 0 0 1-.998-.577 6 6 0 0 1 1.75-.875c-.294.46-.546.947-.753 1.452m-1.873.15c.47.358.984.652 1.531.874A9.6 9.6 0 0 0 3.78 6.45H1.155a5.25 5.25 0 0 1 1.47-3.098M1.12 7.541h2.625c.038.753.164 1.5.376 2.223a6.7 6.7 0 0 0-1.531.875 5.25 5.25 0 0 1-1.47-3.098m3.377 3.255q.311.76.753 1.453a6 6 0 0 1-1.75-.875q.47-.34.997-.578m2.25 1.663a8.6 8.6 0 0 1-1.208-2.013 6.5 6.5 0 0 1 2.922 0 8.5 8.5 0 0 1-1.207 2.013zm2.755-1.663q.552.235 1.042.578a6.3 6.3 0 0 1-1.75.875q.413-.697.708-1.453m1.873-.148a6.7 6.7 0 0 0-1.531-.875 9.5 9.5 0 0 0 .376-2.223h2.625a5.25 5.25 0 0 1-1.47 3.098"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h14v14H0z"></path></clipPath></defs></svg></a><ul class="dropdown__menu"><li><a href="/blog/2025/07/15/modernizing-datainfra-peloton-hudi" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/cn/blog/2025/07/15/modernizing-datainfra-peloton-hudi" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="cn">Chinese</a></li></ul></div><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://twitter.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-twitter-link" aria-label="Hudi Twitter Handle"></a><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-33fabmxb7-Q7QSUtNOHYCwUdYM8LbauA" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-slack-link" aria-label="Hudi Slack Channel"></a><a href="https://www.youtube.com/channel/UCs7AhE0BWaEPZSChrBR-Muw" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-youtube-link" aria-label="Hudi YouTube Channel"></a><a href="https://www.linkedin.com/company/apache-hudi/?viewAsMember=true" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-linkedin-link" aria-label="Hudi Linkedin Page"></a><div class="navbarSearchContainer_Bca1"><div><div role="button" class="searchButton_o6KI" aria-label="Search"><span class="searchText_sHOJ">Search</span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 14 14"><circle cx="6.864" cy="6.864" r="5.243" stroke="#1C1E21" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></circle><path stroke="#1C1E21" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m10.51 10.783 2.056 2.05"></path></svg></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar navbarSideMenu_TODO"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><div class="navbar__logo navbarLogo_aghy"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><button type="button" aria-label="Close navigation bar" class="clean-btn navbar-sidebar__close"><svg viewBox="0 0 15 15" width="21" height="21"><g stroke="var(--ifm-color-emphasis-600)" stroke-width="1.2"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><div class="navbar-sidebar__items"><div class="navbar-sidebar__item menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/docs/overview">Docs</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Learn</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Contribute</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Community</a></li><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/ecosystem">Ecosystem</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbarFontSize_pR5Q menu__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/powered-by">Who&#x27;s Using</a></li><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/roadmap">Roadmap</a></li><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/releases/download">Download</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Versions</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret locale-dropdown-wrapper"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Languages<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 14 14" class="globeIcon_RxQM"><g clip-path="url(#a)"><path fill="#1C1E21" d="M14 6.457a6.84 6.84 0 0 0-7-6.02 6.843 6.843 0 0 0-7 6.02v1.085a6.843 6.843 0 0 0 7 6.02 6.843 6.843 0 0 0 7-6.02zm-1.094 0h-2.625a10 10 0 0 0-.376-2.222 6.7 6.7 0 0 0 1.531-.875 5.25 5.25 0 0 1 1.444 3.097zm-8.032 0a8.5 8.5 0 0 1 .324-1.872 7.4 7.4 0 0 0 3.63 0c.175.61.284 1.239.325 1.872zm4.305 1.085a8.4 8.4 0 0 1-.324 1.873 7.46 7.46 0 0 0-3.658 0 8.5 8.5 0 0 1-.323-1.873zm.35-4.375A10.3 10.3 0 0 0 8.75 1.75c.627.194 1.218.49 1.75.875a5.8 5.8 0 0 1-.998.577zM7.254 1.54A8.8 8.8 0 0 1 8.46 3.552c-.48.11-.97.165-1.461.167-.492-.001-.982-.057-1.461-.167.308-.722.715-1.4 1.207-2.012zM4.498 3.202a5.8 5.8 0 0 1-.998-.577 6 6 0 0 1 1.75-.875c-.294.46-.546.947-.753 1.452m-1.873.15c.47.358.984.652 1.531.874A9.6 9.6 0 0 0 3.78 6.45H1.155a5.25 5.25 0 0 1 1.47-3.098M1.12 7.541h2.625c.038.753.164 1.5.376 2.223a6.7 6.7 0 0 0-1.531.875 5.25 5.25 0 0 1-1.47-3.098m3.377 3.255q.311.76.753 1.453a6 6 0 0 1-1.75-.875q.47-.34.997-.578m2.25 1.663a8.6 8.6 0 0 1-1.208-2.013 6.5 6.5 0 0 1 2.922 0 8.5 8.5 0 0 1-1.207 2.013zm2.755-1.663q.552.235 1.042.578a6.3 6.3 0 0 1-1.75.875q.413-.697.708-1.453m1.873-.148a6.7 6.7 0 0 0-1.531-.875 9.5 9.5 0 0 0 .376-2.223h2.625a5.25 5.25 0 0 1-1.47 3.098"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h14v14H0z"></path></clipPath></defs></svg></a></li><li class="menu__list-item"><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li><li class="menu__list-item"><a href="https://twitter.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="menu__link header-twitter-link" aria-label="Hudi Twitter Handle"></a></li><li class="menu__list-item"><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-33fabmxb7-Q7QSUtNOHYCwUdYM8LbauA" target="_blank" rel="noopener noreferrer" class="menu__link header-slack-link" aria-label="Hudi Slack Channel"></a></li><li class="menu__list-item"><a href="https://www.youtube.com/channel/UCs7AhE0BWaEPZSChrBR-Muw" target="_blank" rel="noopener noreferrer" class="menu__link header-youtube-link" aria-label="Hudi YouTube Channel"></a></li><li class="menu__list-item"><a href="https://www.linkedin.com/company/apache-hudi/?viewAsMember=true" target="_blank" rel="noopener noreferrer" class="menu__link header-linkedin-link" aria-label="Hudi Linkedin Page"></a></li></ul></div><div class="navbar-sidebar__item menu"><button type="button" class="clean-btn navbar-sidebar__back">← Back to main menu</button></div></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-2" itemscope="" itemtype="http://schema.org/Blog"><article class=""><header><h1 class="title_xvU1">Modernizing Data Infrastructure at Peloton Using Apache Hudi</h1><div class="container_iJTo margin-vert--sm"><time datetime="2025-07-15T00:00:00.000Z">July 15, 2025</time><div class="row"><div class="authorWrapper_ApDF col col--12 authorCol_q4o9">Amaresh Bingumalla, Thinh Kenny Vu, Gabriel Wang, Arun Vasudevan in collaboration with Dipankar Mazumdar</div></div><span class="marker_H0Am">9 min read</span></div><div class="row tagsListInline margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/apache-hudi">Apache Hudi</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/peloton">Peloton</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/community">Community</a></li></ul></div></div></header><div id="__blog-post-container" class="markdown"><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>TL;DR</div><div class="admonitionContent_BuS1"><p>Peloton re-architected its data platform using Apache Hudi to overcome snapshot delays, rigid service coupling, and high operational costs. By adopting CDC-based ingestion from PostgreSQL and DynamoDB, moving from CoW to MoR tables, and leveraging asynchronous services with fine-grained schema control, Peloton achieved 10-minute ingestion cycles, reduced compute/storage overhead, and enabled time travel and GDPR compliance.</p></div></div>
<p>Peloton is a global interactive fitness platform that delivers connected, instructor-led fitness experiences to millions of members worldwide. Known for its immersive classes and cutting-edge equipment, Peloton combines software, hardware, and data to create personalized workout journeys. With a growing member base and increasing product diversity, data has become central to how Peloton delivers value. The <em>Data Platform</em> team at Peloton is responsible for building and maintaining the core infrastructure that powers analytics, reporting, and real-time data applications. Their work ensures that data flows seamlessly from transactional systems to the data lake, enabling teams across the organization to make timely, data-driven decisions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-challenge-data-growth-latency-and-operational-bottlenecks">The Challenge: Data Growth, Latency, and Operational Bottlenecks<a href="#the-challenge-data-growth-latency-and-operational-bottlenecks" class="hash-link" aria-label="Direct link to The Challenge: Data Growth, Latency, and Operational Bottlenecks" title="Direct link to The Challenge: Data Growth, Latency, and Operational Bottlenecks">​</a></h2>
<p>As Peloton evolved into a global interactive fitness platform, its data infrastructure was challenged by the growing need for timely insights, agile service migrations, and cost-effective analytics. Daily operations, recommendation systems, and compliance requirements demanded an architecture that could support near real-time access, high-frequency updates, and scalable service boundaries.</p>
<p>However, the team faced persistent bottlenecks with the existing setup:</p>
<ul>
<li>Reporting pipelines were gated by the completion of full snapshot jobs.</li>
<li>Recommender systems could only function on daily refreshed datasets.</li>
<li>The analytics platform was tightly coupled with operational systems.</li>
<li>Microservice migrations were constrained to all-at-once shifts.</li>
<li>Database read replicas incurred high infrastructure costs.</li>
</ul>
<p>These limitations made it difficult to meet SLA expectations, scale workloads efficiently, and adapt the platform to new user and product needs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-legacy-architecture">The Legacy Architecture<a href="#the-legacy-architecture" class="hash-link" aria-label="Direct link to The Legacy Architecture" title="Direct link to The Legacy Architecture">​</a></h2>
<img src="/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/pel_fig1.png" alt="challenge" width="1000" align="middle">
<p>Peloton&#x27;s earlier architecture relied on daily snapshots from a monolithic <strong>PostgreSQL</strong> database. The analytics systems would consume these snapshots, often waiting hours for completion. This not only delayed reporting but also introduced downstream rigidity.</p>
<p>Because the same data platform supported both online and analytical workloads, any schema or service migration required significant planning and coordination. Database read replicas, used to scale reads, increased cost overhead. Moreover, recommendation systems that depended on data freshness were constrained by the snapshot interval, limiting personalization capabilities. This architecture struggled to support a fast-moving product roadmap, near real-time analytics, and the data agility needed to experiment and iterate.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reimagining-the-data-platform-with-apache-hudi">Reimagining the Data Platform with Apache Hudi<a href="#reimagining-the-data-platform-with-apache-hudi" class="hash-link" aria-label="Direct link to Reimagining the Data Platform with Apache Hudi" title="Direct link to Reimagining the Data Platform with Apache Hudi">​</a></h2>
<img src="/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/pel_fig2.png" alt="challenge" width="1000" align="middle">
<p>To address these challenges, the data platform team introduced Apache Hudi as the foundation of its modern data lake. The architecture was rebuilt to support Change Data Capture (CDC) ingestion from both PostgreSQL and DynamoDB using Debezium, with Kafka acting as the transport layer. A custom-built Hudi writer was developed to ingest CDC records into S3 using Apache Spark on EMR (version 6.12.0 with Hudi 0.13.1).</p>
<p>Peloton initially chose Copy-on-Write (CoW) table formats to support querying via Redshift Spectrum and simplify adoption. However, performance and cost bottlenecks prompted a transition to Merge-on-Read (MoR) tables with asynchronous table services for cleaning and compaction.</p>
<p>Key architectural enhancements included:</p>
<ul>
<li><strong>Support for GDPR compliance</strong> through structured delete propagation.</li>
<li><strong>Time travel queries</strong> for recommender model training and data recovery.</li>
<li><strong>Phased migration support</strong> for microservices via decoupled ingestion.</li>
</ul>
<p>Peloton&#x27;s broader data platform tech stack supports this architecture with a range of tools for orchestration, analytics, and governance. This includes EMR for compute, Redshift for querying, DBT for data transformations, Looker for BI and visualization, Airflow for orchestration, and DataHub for metadata management. These components complement Apache Hudi in forming a modular and production-ready lakehouse stack.</p>
<img src="/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/pel_fig3.png" alt="challenge" width="1000" align="middle">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="learnings-from-running-hudi-at-scale">Learnings from Running Hudi at Scale<a href="#learnings-from-running-hudi-at-scale" class="hash-link" aria-label="Direct link to Learnings from Running Hudi at Scale" title="Direct link to Learnings from Running Hudi at Scale">​</a></h2>
<p>With Hudi now integrated into Peloton&#x27;s data lake, the team began to observe and address new operational and architectural challenges that emerged at scale. This section outlines the major lessons learned while maintaining high-ingestion throughput, ensuring data reliability, and keeping infrastructure costs under control.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cow-vs-mor-performance-trade-offs">CoW vs MoR: Performance Trade-offs<a href="#cow-vs-mor-performance-trade-offs" class="hash-link" aria-label="Direct link to CoW vs MoR: Performance Trade-offs" title="Direct link to CoW vs MoR: Performance Trade-offs">​</a></h3>
<p>Initially, Copy-on-Write (CoW) tables were chosen to simplify deployment and ensure compatibility with Redshift Spectrum. However, as ingestion frequency increased and update volumes spanned hundreds of partitions, performance became a bottleneck. Some high-frequency tables with updates across 256 partitions took nearly an hour to process per run. Additionally, retaining 30 days of commits for training recommender models significantly inflated storage requirements, reaching into the hundreds of gigabytes.</p>
<img src="/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/pel_fig4.png" alt="challenge" width="1000" align="middle">
<p>To resolve this, the team migrated to Hudi’s Merge-on-Read (MoR) tables and reduced commit retention to 7 days. With ingestion jobs now running every 10 minutes, latency dropped significantly, and storage and compute usage became more efficient.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="async-vs-inline-table-services">Async vs Inline Table Services<a href="#async-vs-inline-table-services" class="hash-link" aria-label="Direct link to Async vs Inline Table Services" title="Direct link to Async vs Inline Table Services">​</a></h3>
<p>To improve write throughput and meet low-latency ingestion goals, the Peloton team initially configured Apache Hudi with asynchronous cleaner and compactor services. This approach worked well across most tables, allowing ingestion pipelines to run every 10 minutes with minimal blocking but introduced some operational edge cases. Some of the challenges encountered included:</p>
<ul>
<li>Concurrent execution of writer and cleaner jobs, leading to conflicts. These were mitigated by introducing DynamoDB-based locks to serialize access.</li>
<li>Reader-cleaner race conditions, where time travel queries intermittently failed with <code>&quot;File Not Found&quot;</code> errors - traced back to cleaners deleting files mid-read.</li>
<li>Compaction disruptions caused by EMR node terminations, which led to orphaned files when jobs failed mid-way.</li>
</ul>
<p>These edge cases were largely due to the operational complexity of managing concurrent workloads at Peloton’s scale. After weighing reliability against latency, the team opted to switch to inline table services for compaction and cleaning, augmented with custom logic to control when these actions would run. This change improved system stability while maintaining acceptable latency trade-offs.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="glue-schema-version-limits">Glue Schema Version Limits<a href="#glue-schema-version-limits" class="hash-link" aria-label="Direct link to Glue Schema Version Limits" title="Direct link to Glue Schema Version Limits">​</a></h3>
<p>As schema evolution continued, the team used Hudi&#x27;s <code>META_SYNC_ENABLED</code> to sync schema updates with AWS Glue. Over time, high-frequency schema updates pushed the number of <code>TABLE_VERSION</code> resources in Glue beyond the <em>1 million</em> limit. This caused jobs to fail in ways that were initially difficult to trace.</p>
<p>One such failure manifested as the following error:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ERROR Client: Application diagnostics message: User class threw exception:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">java.lang.NoSuchMethodError: &#x27;org.apache.hudi.exception.HoodieException </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.hudi.sync.common.util.SyncUtilHelpers.getExceptionFromList(java.util.Collection)&#x27;</span><br></span></code></pre></div></div>
<p>After significant debugging, the issue was traced to AWS Glue limits. The team implemented a multi-step fix:</p>
<ul>
<li>Worked with AWS to temporarily raise resource limits.</li>
<li>Developed a Python service to identify and delete outdated table versions, removing over 1 million entries.</li>
<li>Added an Airflow job to schedule weekly cleanup tasks.</li>
<li>Improved schema sync logic to trigger only when the schema changed.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="debezium--toast-handling">Debezium &amp; TOAST Handling<a href="#debezium--toast-handling" class="hash-link" aria-label="Direct link to Debezium &amp; TOAST Handling" title="Direct link to Debezium &amp; TOAST Handling">​</a></h3>
<p>PostgreSQL CDC ingestion posed unique challenges due to the database’s handling of large fields using TOAST (The Oversized-Attribute Storage Technique). When fields over 8KB were unchanged, Debezium emitted a placeholder value <code>__debezium_unavailable_value</code>, making it impossible to determine whether the value had changed.</p>
<img src="/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/pel_fig5.png" alt="challenge" width="1000" align="middle">
<p>To address this, Peloton:</p>
<ul>
<li>Populated initial data using PostgreSQL snapshots.</li>
<li>Implemented self-joins between incoming CDC records and existing Hudi records to fill in missing values.</li>
<li>Separated inserts, updates, and deletes within Spark batch processing.</li>
<li>Used the <code>ts</code> field as the precombine key to ensure only the latest record state was retained.</li>
</ul>
<p>A reconciliation pipeline was also developed to heal data inconsistencies caused by multiple operations on the same key within a batch (e.g., create-delete-create).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-validation-and-quality-enforcement">Data Validation and Quality Enforcement<a href="#data-validation-and-quality-enforcement" class="hash-link" aria-label="Direct link to Data Validation and Quality Enforcement" title="Direct link to Data Validation and Quality Enforcement">​</a></h3>
<p>Data quality was critical to ensure trust in the newly established data lake. The team developed several internal libraries and checks:</p>
<ul>
<li>A Crypto Shredding Library to encrypt <code>user_id</code> and other PII fields before storage.</li>
<li>A Data Validation Framework that compared records in the lake against snapshot data.</li>
<li>A Data Quality Library that enforced column-level thresholds. These checks integrated with DataHub and were tied to Airflow sensors to halt downstream jobs on failures.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dynamodb-ingestion-and-schema-challenges">DynamoDB Ingestion and Schema Challenges<a href="#dynamodb-ingestion-and-schema-challenges" class="hash-link" aria-label="Direct link to DynamoDB Ingestion and Schema Challenges" title="Direct link to DynamoDB Ingestion and Schema Challenges">​</a></h3>
<p>Some Peloton services relied on DynamoDB for operational workloads (NoSQL). To ingest these datasets into the lake, the team used DynamoDB Streams and a Kafka Connector, allowing reuse of the existing Kafka-based Hudi ingestion path.</p>
<img src="/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/pel_fig6.png" alt="challenge" width="1000" align="middle">
<p>However, the NoSQL nature of DynamoDB introduced schema management challenges. Two strategies were evaluated:</p>
<ol>
<li>Stakeholder-defined schemas, using SUPER-type fields.</li>
<li>Dynamic schema inference, where incoming JSON records were parsed, and the evolving schema was inferred and reconciled.</li>
</ol>
<p>The team opted for dynamic inference despite increased processing time, as it enabled better support for exploratory workloads. Daily snapshots and reconciliation steps helped clean up inconsistent schema states.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reducing-operational-costs">Reducing Operational Costs<a href="#reducing-operational-costs" class="hash-link" aria-label="Direct link to Reducing Operational Costs" title="Direct link to Reducing Operational Costs">​</a></h3>
<img src="/assets/images/blog/2025-07-15-modernizing-datainfra-peloton-hudi/pel_fig7.png" alt="challenge" width="1000" align="middle">
<p>As the system matured, cost optimization became a priority. The team used <a href="https://github.com/ganglia/" target="_blank" rel="noopener noreferrer">Ganglia</a> to analyze job profiles and identify areas for improvement:</p>
<ul>
<li>EMR resources were gradually right-sized based on CPU and memory usage.</li>
<li>Conditional Hive syncing was introduced to avoid unnecessary sync operations during each run.</li>
<li>A Spark-side inefficiency was discovered where archived timelines were unnecessarily loaded, causing jobs to take 4x longer. Fixing this reduced overall latency and compute resource usage.</li>
</ul>
<p>These operational refinements significantly reduced idle times and improved the cost-efficiency of the platform.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gains-from-hudi-adoption">Gains from Hudi Adoption<a href="#gains-from-hudi-adoption" class="hash-link" aria-label="Direct link to Gains from Hudi Adoption" title="Direct link to Gains from Hudi Adoption">​</a></h2>
<p>Peloton&#x27;s transition to Apache Hudi led to measurable performance, operational, and cost-related improvements across its modern data platform.</p>
<p>Peloton&#x27;s transition to Apache Hudi yielded several measurable improvements:</p>
<ul>
<li>Ingestion frequency increased from once daily to every 10 minutes.</li>
<li>Reduced snapshot job durations from an hour to under 15 minutes.</li>
<li>Cost savings by eliminating read replicas and optimizing EMR cluster usage.</li>
<li>Time travel support enabled retrospective analysis and model re-training.</li>
<li>Improved compliance posture through structured deletes and encrypted PII.</li>
</ul>
<p>The modernization laid the groundwork for future evolution, including real-time streaming ingestion using Apache Flink and continued improvements in data freshness, latency, and governance.</p>
<p>This blog is based on Peloton’s presentation at the Apache Hudi Community Sync. If you are interested in watching the recorded version of the video, you can find it <a href="https://youtu.be/-Pyid5K9dyU?feature=shared" target="_blank" rel="noopener noreferrer">here</a>.</p>
<hr></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/apache/hudi/edit/asf-site/website/blog/blog/2025-07-15-modernizing-datainfra-peloton-hudi.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2025/07/21/mor-comparison"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">A Deep Dive on Merge-on-Read (MoR) in Lakehouse Table Formats</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2025/07/15/PayU-built-a-secure-enterprise-AI-assistant"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">How PayU built a secure enterprise AI assistant using Amazon Bedrock</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-challenge-data-growth-latency-and-operational-bottlenecks" class="table-of-contents__link toc-highlight">The Challenge: Data Growth, Latency, and Operational Bottlenecks</a></li><li><a href="#the-legacy-architecture" class="table-of-contents__link toc-highlight">The Legacy Architecture</a></li><li><a href="#reimagining-the-data-platform-with-apache-hudi" class="table-of-contents__link toc-highlight">Reimagining the Data Platform with Apache Hudi</a></li><li><a href="#learnings-from-running-hudi-at-scale" class="table-of-contents__link toc-highlight">Learnings from Running Hudi at Scale</a><ul><li><a href="#cow-vs-mor-performance-trade-offs" class="table-of-contents__link toc-highlight">CoW vs MoR: Performance Trade-offs</a></li><li><a href="#async-vs-inline-table-services" class="table-of-contents__link toc-highlight">Async vs Inline Table Services</a></li><li><a href="#glue-schema-version-limits" class="table-of-contents__link toc-highlight">Glue Schema Version Limits</a></li><li><a href="#debezium--toast-handling" class="table-of-contents__link toc-highlight">Debezium &amp; TOAST Handling</a></li><li><a href="#data-validation-and-quality-enforcement" class="table-of-contents__link toc-highlight">Data Validation and Quality Enforcement</a></li><li><a href="#dynamodb-ingestion-and-schema-challenges" class="table-of-contents__link toc-highlight">DynamoDB Ingestion and Schema Challenges</a></li><li><a href="#reducing-operational-costs" class="table-of-contents__link toc-highlight">Reducing Operational Costs</a></li></ul></li><li><a href="#gains-from-hudi-adoption" class="table-of-contents__link toc-highlight">Gains from Hudi Adoption</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">About</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/2021/07/21/streaming-data-lake-platform">Our Vision</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/community/team">Team</a></li><li class="footer__item"><a class="footer__link-item" href="/releases/release-1.0.2">Releases</a></li><li class="footer__item"><a class="footer__link-item" href="/releases/download">Download</a></li><li class="footer__item"><a class="footer__link-item" href="/powered-by">Who&#x27;s Using</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quick-start-guide">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/tutorial-series">Tutorial Series</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/talks">Talks</a></li><li class="footer__item"><a class="footer__link-item" href="/videos">Video Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQ</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Hudi On Cloud</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/s3_hoodie">AWS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/gcs_hoodie">Google Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/oss_hoodie">Alibaba Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/azure_hoodie">Microsoft Azure</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cos_hoodie">Tencent Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/ibm_cos_hoodie">IBM Cloud</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community/get-involved">Get Involved</a></li><li class="footer__item"><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-33fabmxb7-Q7QSUtNOHYCwUdYM8LbauA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCs7AhE0BWaEPZSChrBR-Muw" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/apache-hudi/?viewAsMember=true" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:dev-subscribe@hudi.apache.org?Subject=SubscribeToHudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Apache</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li><li class="footer__item"><a href="https://www.apache.org/licenses" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a class="footer__link-item" href="/asf/telemetry">Telemetry</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://hudi.apache.org/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/assets/images/logo-big.png" alt="Apache Hudi™" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/logo-big.png" alt="Apache Hudi™" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">Copyright © 2021 <a href="https://apache.org">The Apache Software Foundation</a>, Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0"> Apache License, Version 2.0</a>. <br>Hudi, Apache and the Apache feather logo are trademarks of The Apache Software Foundation.<img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=8f594acf-9b77-44fb-9475-3e82ead1910c"><img referrerpolicy="no-referrer-when-downgrade" src="https://analytics.apache.org/matomo.php?idsite=47&amp;rec=1"></div></div></div></footer></div>
</body>
</html>