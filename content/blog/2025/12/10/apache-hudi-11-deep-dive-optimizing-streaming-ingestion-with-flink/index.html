<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Apache Hudi 1.1 Deep Dive: Optimizing Streaming Ingestion with Apache Flink | Apache Hudi</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hudi.apache.org/blog/2025/12/10/apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="apache hudi, data lake, lakehouse, big data, apache spark, apache flink, presto, trino, analytics, data engineering"><meta data-rh="true" property="og:title" content="Apache Hudi 1.1 Deep Dive: Optimizing Streaming Ingestion with Apache Flink | Apache Hudi"><meta data-rh="true" name="description" content="---"><meta data-rh="true" property="og:description" content="---"><meta data-rh="true" property="og:image" content="https://hudi.apache.org/assets/images/blog/2025-12-10-apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink/benchmark-string-schemas.png"><meta data-rh="true" name="twitter:image" content="https://hudi.apache.org/assets/images/blog/2025-12-10-apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink/benchmark-string-schemas.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-12-10T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="hudi,flink,performance"><link data-rh="true" rel="icon" href="/assets/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://hudi.apache.org/blog/2025/12/10/apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink"><link data-rh="true" rel="alternate" href="https://hudi.apache.org/blog/2025/12/10/apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink" hreflang="en"><link data-rh="true" rel="alternate" href="https://hudi.apache.org/blog/2025/12/10/apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://hudi.apache.org/blog/2025/12/10/apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink","mainEntityOfPage":"https://hudi.apache.org/blog/2025/12/10/apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink","url":"https://hudi.apache.org/blog/2025/12/10/apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink","headline":"Apache Hudi 1.1 Deep Dive: Optimizing Streaming Ingestion with Apache Flink","name":"Apache Hudi 1.1 Deep Dive: Optimizing Streaming Ingestion with Apache Flink","description":"---","datePublished":"2025-12-10T00:00:00.000Z","author":{"@type":"Person","name":"Shuo Cheng"},"image":{"@type":"ImageObject","@id":"https://hudi.apache.org/assets/images/blog/2025-12-10-apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink/benchmark-string-schemas.png","url":"https://hudi.apache.org/assets/images/blog/2025-12-10-apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink/benchmark-string-schemas.png","contentUrl":"https://hudi.apache.org/assets/images/blog/2025-12-10-apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink/benchmark-string-schemas.png","caption":"title image for the blog post: Apache Hudi 1.1 Deep Dive: Optimizing Streaming Ingestion with Apache Flink"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://hudi.apache.org/blog","name":"Blogs List Page"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Hudi: User-Facing Analytics RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Hudi: User-Facing Analytics Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Apache Hudi: User-Facing Analytics JSON Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Apache Hudi" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/videos/rss.xml" title="Apache Hudi RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/videos/atom.xml" title="Apache Hudi Atom Feed">





<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="9e4444ba-93cc-45ea-b143-783ae0fbeb6f" data-project-name="Apache Hudi" data-project-color="#FFFFFF" data-project-logo="/assets/images/logo-big.png" data-modal-disclaimer="This AI assistant answers Apache Hudi questions using your [documentation](https://hudi.apache.org/docs/quick-start-guide/), [dev setup](https://hudi.apache.org/contribute/developer-setup/), the [tech specs](https://hudi.apache.org/tech-specs-1point0/) and [open GitHub Issues](https://github.com/apache/hudi/issues/) from the last year." data-modal-title="Apache Hudi AI Assistant" data-modal-example-questions-title="Try asking me..." data-modal-example-questions="How can I convert an existing COW table to MOR?,How do I set up incremental queries with Hudi tables?" data-modal-image="/assets/images/logo-small.png" data-modal-image-ask-ai="/assets/images/logo-small.png" data-modal-header-min-height="64px" data-modal-image-height="44" data-modal-image-width="64" data-modal-header-bg-color="#f8f9fa" data-modal-title-color="#15467D" data-button-text-color="#29557a" data-button-text="Ask AI" data-consent-required="true" data-consent-screen-title="Help us improve our AI assistant" data-consent-screen-disclaimer="By clicking &amp;quot;Allow tracking&amp;quot;, you consent to the use of the AI assistant in accordance with kapa.ai&#39;s [Privacy Policy](https://www.kapa.ai/content/privacy-policy). This service uses reCAPTCHA, which requires your consent to Google&#39;s [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms). By proceeding, you explicitly agree to both kapa.ai&#39;s and Google&#39;s privacy policies." data-consent-screen-accept-button-text="Allow tracking" data-modal-disclaimer-font-size="0.80rem" data-query-input-placeholder-text-color="#29557a" data-submit-query-button-bg-color="#228EDE" data-query-input-text-color="#29557a" data-user-analytics-cookie-enabled="false" data-query-input-border-color="#211b0e" data-question-text-color="#0db1f9" data-answer-text-color="#000" data-thread-clear-button-bg-color="#000000" data-thread-clear-button-text-color="#FFFFFF" data-answer-feedback-button-bg-color="#000000" data-answer-feedback-button-text-color="#FFFFFF" data-answer-feedback-button-active-bg-color="#000000" data-answer-feedback-button-active-text-color="#FFFFFF" data-answer-copy-button-bg-color="#000000" data-answer-copy-button-text-color="#FFFFFF" data-example-question-button-text-color="#29557a" data-modal-disclaimer-bg-color="#f8f9fa" data-modal-disclaimer-text-color="#15467D" data-deep-thinking-button-bg-color="#228EDE" data-deep-thinking-button-text-color="#FFFFFF" data-deep-thinking-button-active-bg-color="#205792" data-deep-thinking-button-hover-bg-color="#0478C0" data-deep-thinking-button-active-hover-bg-color="#205792" data-deep-thinking-button-active-text-color="#FFFFFF" async></script><link rel="stylesheet" href="/assets/css/styles.abb0228d.css">
<script src="/assets/js/runtime~main.896d1329.js" defer="defer"></script>
<script src="/assets/js/main.28983876.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" role="banner"><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like <b>Apache Hudi</b>, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/apache/hudi"><b>GitHub!<svg xmlns="http://www.w3.org/2000/svg\" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 -2 16 16"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg></b></a> ⭐</div></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarWrapper_j_uY"><div class="navbar__inner navbarInnerStyle_KoMw"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo navbarLogo_aghy"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs/overview">Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/learn/tutorial-series">Tutorial Series</a></li><li><a class="dropdown__link" href="/learn/blog">Blogs</a></li><li><a class="dropdown__link" href="/learn/talks">Talks</a></li><li><a class="dropdown__link" href="/learn/videos">Video Guides</a></li><li><a class="dropdown__link" href="/learn/faq">FAQ</a></li><li><a class="dropdown__link" href="/learn/tech-specs">Tech Specs</a></li><li><a class="dropdown__link" href="/learn/tech-specs-1point0">Tech Specs 1.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Contribute</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contribute/developer-sync-call">Developer Sync Call</a></li><li><a class="dropdown__link" href="/contribute/how-to-contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/contribute/developer-setup">Developer Setup</a></li><li><a class="dropdown__link" href="/contribute/rfc-process">RFC Process</a></li><li><a class="dropdown__link" href="/contribute/security">Security</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/get-involved">Get Involved</a></li><li><a class="dropdown__link" href="/community/syncs">Community Syncs</a></li><li><a class="dropdown__link" href="/community/office_hours">Office Hours</a></li><li><a class="dropdown__link" href="/community/team">Team</a></li><li><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="dropdown__link">Github<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-33fabmxb7-Q7QSUtNOHYCwUdYM8LbauA" target="_blank" rel="noopener noreferrer" class="dropdown__link">Slack<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.linkedin.com/company/apache-hudi/" target="_blank" rel="noopener noreferrer" class="dropdown__link">LinkedIn<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.youtube.com/@apachehudi" target="_blank" rel="noopener noreferrer" class="dropdown__link">YouTube<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://x.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="dropdown__link">X<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Ecosystem</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/powered-by">Adopters</a></li><li><a class="dropdown__link" href="/roadmap">Roadmap</a></li><li><a class="dropdown__link" href="/ecosystem">Integrations</a></li></ul></div><a class="navbar__item navbar__link" href="/releases/download">Download</a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div><div role="button" class="searchButton_o6KI" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 14 14"><circle cx="6.864" cy="6.864" r="5.243" stroke="#15467D" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></circle><path stroke="#15467D" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m10.51 10.783 2.056 2.05"></path></svg></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar navbarSideMenu_TODO"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><div class="navbar__logo navbarLogo_aghy"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/hudi.png" alt="Apache Hudi" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><button type="button" aria-label="Close navigation bar" class="clean-btn navbar-sidebar__close"><svg viewBox="0 0 15 15" width="21" height="21"><g stroke="var(--ifm-color-emphasis-600)" stroke-width="1.2"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><div class="navbar-sidebar__items"><div class="navbar-sidebar__item menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/docs/overview">Docs</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Learn</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Contribute</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Community</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_JUhd menu__link menu__link--sublist menu__link--sublist-caret navbarFontSize_pR5Q">Ecosystem</a></li><li class="menu__list-item"><a class="menu__link navbarFontSize_pR5Q" href="/releases/download">Download</a></li></ul></div><div class="navbar-sidebar__item menu"><button type="button" class="clean-btn navbar-sidebar__back">← Back to main menu</button></div></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-2" itemscope="" itemtype="http://schema.org/Blog"><article class=""><header><h1 class="title_xvU1">Apache Hudi 1.1 Deep Dive: Optimizing Streaming Ingestion with Apache Flink</h1><div class="container_iJTo margin-vert--sm"><time datetime="2025-12-10T00:00:00.000Z">December 10, 2025</time><div class="row"><div class="authorWrapper_ApDF col col--12 authorCol_q4o9">Shuo Cheng</div></div><span class="marker_H0Am">10 min read</span></div><div class="row tagsListInline margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/hudi">hudi</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/flink">flink</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/performance">performance</a></li></ul></div></div></header><div id="__blog-post-container" class="markdown"><hr>
<p><em>This blog was translated from the <a href="https://mp.weixin.qq.com/s/ek80Fzw30FOawk1qeWxtCw" target="_blank" rel="noopener noreferrer" class="">original blog in Chinese</a>.</em></p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="background">Background<a href="#background" class="hash-link" aria-label="Direct link to Background" title="Direct link to Background" translate="no">​</a></h2>
<p>With the rise of real-time data processing, streaming ingestion has become a critical use case for Apache Hudi. Apache Flink, a robust stream processing framework, has been seamlessly integrated with Hudi to support near-real-time data ingestion. While the Flink integration has already provided powerful and comprehensive capabilities—such as robust exactly-once guarantees backed by Flink&#x27;s checkpointing mechanism, flexible write modes, and rich index management—as data volumes scale into petabytes, achieving optimal performance for streaming ingestion becomes a challenge, leading to backpressure and high resource costs for streaming jobs.</p>
<p>There are multiple factors that impact streaming ingestion performance, such as the network shuffle overhead between Flink operators, SerDe costs within Hudi writers, and GC issues caused by memory management of in-memory buffers. With Hudi 1.1, meticulous refactoring and optimization work has been conducted to solve these problems, significantly enhancing the performance and stability of streaming ingestion with Flink.</p>
<p>In the subsequent sections, several key performance optimizations are introduced, including:</p>
<ul>
<li class="">Optimized SerDe between Flink operators</li>
<li class="">New performant Flink-native writers</li>
<li class="">Eliminated bytes copy for MOR log file writing</li>
</ul>
<p>Following that, performance benchmarks for streaming ingestion in Hudi 1.1 are presented to demonstrate the concrete improvements achieved.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="optimized-serde-between-flink-operators">Optimized SerDe Between Flink Operators<a href="#optimized-serde-between-flink-operators" class="hash-link" aria-label="Direct link to Optimized SerDe Between Flink Operators" title="Direct link to Optimized SerDe Between Flink Operators" translate="no">​</a></h2>
<p>Before Hudi 1.1, Avro was the default internal record format in the Flink writing/reading path, which means the first step in the write pipeline was converting Flink <code>RowData</code> into Avro record payload, and then it was used to create Hudi internal <code>HoodieRecord</code> for the following processing.</p>
<p><img decoding="async" loading="lazy" alt="Flink write pipeline before Hudi 1.1" src="/assets/images/flink-write-pipeline-before-1.1-b032868a09523f533cd153e5b4916a37.png" width="5798" height="1176" class="img_ev3q"></p>
<p>Almost every Flink job has to exchange data between its operators, and when the operators are not chained together (located in the same JVM process), records need to be serialized to bytes first before being sent to the downstream operator through the network. The shuffle serialization alone can be quite costly if not executed efficiently, and thus, when you examine the profiler output of the job, you will likely see serialization among the top consumers of CPU cycles. Flink actually has an out-of-the-box serialization framework, and there are performant internal serializers for basic types, like primitive types and row type. However, for generic types, e.g., <code>HoodieRecord</code>, Flink will fall back to the default serializer based on Kryo, which exhibits poor serialization performance.</p>
<p><a href="https://github.com/apache/hudi/blob/master/rfc/rfc-84/rfc-84.md" target="_blank" rel="noopener noreferrer" class="">RFC-84</a> proposed an improvement on SerDe between operators in the Hudi write pipeline based on the extensible type system of Flink:</p>
<ul>
<li class=""><code>HoodieFlinkInternalRow</code>: an object to replace <code>HoodieRecord</code> during data shuffle, which contains <code>RowData</code> as the data field and some necessary metadata fields, e.g., record key, partition path, etc.</li>
<li class=""><code>HoodieFlinkInternalRowTypeInfo</code>: a customized Flink type information for <code>HoodieFlinkInternalRow</code>.</li>
<li class=""><code>HoodieFlinkInternalRowSerializer</code>: a customized and efficient Flink <code>TypeSerializer</code> for the SerDe of <code>HoodieFlinkInternalRow</code>.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Optimized SerDe with HoodieFlinkInternalRow" src="/assets/images/optimized-serde-hoodie-flink-internal-row-a174bf7843c9b6bcd94d8a8175bbc6cf.png" width="5777" height="1176" class="img_ev3q"></p>
<p>With the customized Flink-native data structure and the companion serializer, the average streaming ingestion throughput can be boosted by about 25%.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="new-performant-flink-native-writers">New Performant Flink-Native Writers<a href="#new-performant-flink-native-writers" class="hash-link" aria-label="Direct link to New Performant Flink-Native Writers" title="Direct link to New Performant Flink-Native Writers" translate="no">​</a></h2>
<p>Historically, Hudi Flink writer used <code>HoodieRecord&lt;AvroPayload&gt;</code> with data serialized using Avro to represent incoming records. While this unified format worked across engines, it came at a performance cost:</p>
<p><img decoding="async" loading="lazy" alt="Legacy Avro-based write path" src="/assets/images/legacy-avro-write-path-6c853a93e2dcfc869834b8208c60260f.png" width="6094" height="1778" class="img_ev3q"></p>
<ul>
<li class=""><strong>Redundant SerDe</strong>: Take MOR table ingestion as an example. Flink reads records as <code>RowData</code>, which are converted to Avro <code>GenericRecord</code> and then serialized to Avro bytes for internal <code>HoodieAvroRecord</code>. During the later log writing, the Avro bytes in <code>HoodieAvroRecord</code> are deserialized back into Avro <code>IndexedRecord</code> for further processing before being appended to log files. Apparently, with Avro as the intermediate record representation, significant SerDe overhead is introduced.</li>
<li class=""><strong>Excess memory usage</strong>: The buffer in the writers is a Java List with intermediate Avro objects which will be released after being flushed to disk. These objects can increase heap usage and GC pressure, particularly under high-throughput streaming workloads.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="rfc-87-a-flink-native-write-path">RFC-87: A Flink-Native Write Path<a href="#rfc-87-a-flink-native-write-path" class="hash-link" aria-label="Direct link to RFC-87: A Flink-Native Write Path" title="Direct link to RFC-87: A Flink-Native Write Path" translate="no">​</a></h3>
<p><a href="https://github.com/apache/hudi/blob/master/rfc/rfc-87/rfc-87.md" target="_blank" rel="noopener noreferrer" class="">RFC-87</a> proposes and implements a shift in data representation: instead of transforming <code>RowData</code> to <code>GenericRecord</code>, the Flink writer now directly wraps <code>RowData</code> inside a specialized <code>HoodieRecord</code>. The entire write path now operates around the <code>RowData</code> structure, eliminating all redundant conversion overhead. This change is Flink engine-specific and transparent to the overall Hudi writer lifecycle.</p>
<p><img decoding="async" loading="lazy" alt="New Flink-native write path" src="/assets/images/flink-native-write-path-2b1938700dea8b09f055fd41a2fae96f.png" width="6094" height="1812" class="img_ev3q"></p>
<p><strong>Key Changes:</strong></p>
<ul>
<li class=""><strong>Customized HoodieRecord</strong>: Introduced <code>HoodieFlinkRecord</code> to encapsulate Flink&#x27;s <code>RowData</code> directly—no extra conversion to Avro record in the writing path anymore.</li>
<li class=""><strong>Self-managed binary buffer</strong>: Flink&#x27;s internal <code>BinaryRowData</code> is in binary format. We&#x27;ve implemented a binary buffer to cache the bytes of the <code>RowData</code>. The memory is managed by the writer and can be reused after the previously cached <code>RowData</code> bytes are flushed to disk. With this self-managed binary buffer, GC pressure can be effectively reduced even under high-throughput workloads.</li>
<li class=""><strong>Flexible log formats</strong>: For MOR tables, records are written as data blocks in log files. We currently support two kinds of block types:<!-- -->
<ul>
<li class=""><strong>Avro data block</strong>: Optimized for row-level writes, making it ideal for streaming ingestion or workloads with frequent updates and inserts. It&#x27;s the default block type for log files.</li>
<li class=""><strong>Parquet data block</strong>: Columnar and better suited for data with a high compression ratio, e.g., records with primitive type fields.</li>
</ul>
</li>
</ul>
<p>By leveraging the Flink-native data model, the redundant Avro conversions along with SerDe overhead are eliminated in the streaming ingestion pipeline, which brings significant improvements in both write latency and resource consumption.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="eliminate-bytes-copy-for-mor-log-file-writing">Eliminate Bytes Copy for MOR Log File Writing<a href="#eliminate-bytes-copy-for-mor-log-file-writing" class="hash-link" aria-label="Direct link to Eliminate Bytes Copy for MOR Log File Writing" title="Direct link to Eliminate Bytes Copy for MOR Log File Writing" translate="no">​</a></h2>
<p>The log file of a MOR table is composed of data blocks. When writing a log file, the basic unit is the data block. The main contents of each block are shown in the figure below, where the <code>Content</code> is binary bytes generated by serializing the records in the buffer into the specified block format.</p>
<p><img decoding="async" loading="lazy" alt="Log file data block structure" src="/assets/images/log-file-data-block-structure-d685ccce3f9a19b496e8036cf3632a70.png" width="1280" height="1106" class="img_ev3q"></p>
<p>As mentioned in the previous section, the default data block format is Avro. In Hudi 1.1, the serialization of this block type has been carefully optimized by eliminating record-level bytes copy. Specifically, before Hudi 1.1, each record was serialized by the Avro Writer into a <code>ByteArrayOutputStream</code>, then the <code>toByteArray</code> method was invoked to obtain the data bytes for writing into the outer output stream for the data block. However, under the hood, <code>toByteArray</code> involves the creation of a new byte array and bytes copy. Since the bytes copy happens at the record level, it generates a large number of temporary objects in high-throughput scenarios, which further increases GC pressure.</p>
<p><img decoding="async" loading="lazy" alt="Bytes copy optimization" src="/assets/images/bytes-copy-optimization-9a2b7caea80f1dfc9d0a5bd1f0521173.png" width="1280" height="496" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="improvement-in-hudi-11">Improvement in Hudi 1.1<a href="#improvement-in-hudi-11" class="hash-link" aria-label="Direct link to Improvement in Hudi 1.1" title="Direct link to Improvement in Hudi 1.1" translate="no">​</a></h3>
<p>In Hudi 1.1, the <code>writeTo</code> method of <code>ByteArrayOutputStream</code> is utilized to directly write the underlying data bytes to the outer output stream for the block, thereby avoiding additional record-level bytes copy and effectively reducing GC pressure.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="benchmark">Benchmark<a href="#benchmark" class="hash-link" aria-label="Direct link to Benchmark" title="Direct link to Benchmark" translate="no">​</a></h2>
<p>To demonstrate performance improvements in streaming ingestion with Flink, we performed comprehensive benchmark testing of Apache Hudi 1.1 vs. Apache Hudi 1.0 vs. Apache Paimon 1.0.1. Currently there is no standard test dataset for streaming read/write. Since it&#x27;s important to run transparent and reproducible benchmarking, we decided to use the existing <a href="https://github.com/apache/paimon/tree/master/paimon-benchmark/paimon-cluster-benchmark" target="_blank" rel="noopener noreferrer" class="">Cluster benchmark program</a> of Apache Paimon inspired by <a href="https://github.com/nexmark/nexmark" target="_blank" rel="noopener noreferrer" class="">Nexmark</a>, as Paimon has previously claimed multi-fold better ingestion performance than Hudi in this benchmark, which is one of their key selling points.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cluster-environment">Cluster Environment<a href="#cluster-environment" class="hash-link" aria-label="Direct link to Cluster Environment" title="Direct link to Cluster Environment" translate="no">​</a></h3>
<p>The benchmarks were run on an Alibaba Cloud EMR cluster, with the following settings:</p>
<ul>
<li class=""><strong>EMR on ECS</strong>: version 5.18.1<!-- -->
<ul>
<li class="">Master (x1): 8 vCPU, 32 GiB, 5 Gbps</li>
<li class="">Worker (x4): 24 vCPU, 96 GiB, 12 Gbps</li>
</ul>
</li>
<li class=""><strong>Apache Hudi version</strong>: 1.1 and 1.0.1</li>
<li class=""><strong>Apache Paimon version</strong>: 1.0.1</li>
<li class=""><strong>Apache Flink version</strong>: 1.17.2</li>
<li class=""><strong>HDFS version</strong>: 3.2.1</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="streaming-ingestion-scenario">Streaming Ingestion Scenario<a href="#streaming-ingestion-scenario" class="hash-link" aria-label="Direct link to Streaming Ingestion Scenario" title="Direct link to Streaming Ingestion Scenario" translate="no">​</a></h3>
<p>The testing scenario is the most common streaming ingestion case in production: MOR table with UPSERT operation and Bucket index. We used the Paimon Benchmark program to simulate the workloads, where the data source was generated by the Flink DataGen connector, which produces records with primary keys ranging from 0 to 100,000,000, and the total record number is 500 million. For more detailed settings, refer to <a href="https://github.com/cshuo/streaming-benchmark" target="_blank" rel="noopener noreferrer" class="">this repository</a>.</p>
<p>Note that we disabled compaction in the test ingestion jobs, since it can significantly impact the performance of the ingestion job for both Hudi and Paimon and interfere with a fair comparison of ingestion performance. In fact, this is also common practice in production.</p>
<p>Additionally, the schema of a table also has a significant impact on write performance. There is a noticeable difference in the processing overhead between numeric primitive type fields and string type fields. Therefore, besides the default table schema (Schema1) used in the Paimon Benchmark program, we also added 3 different schemas containing mostly STRING-type fields, which are much more common in production scenarios.</p>
<table><thead><tr><th>Schema1</th><th>Schema2</th><th>Schema3</th><th>Schema4</th></tr></thead><tbody><tr><td>1 String + 10 BIGINT fields</td><td>20 String fields</td><td>50 String fields</td><td>100 String fields</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="benchmark-results">Benchmark Results<a href="#benchmark-results" class="hash-link" aria-label="Direct link to Benchmark Results" title="Direct link to Benchmark Results" translate="no">​</a></h3>
<ul>
<li class="">For Schema1 with almost all fields being numeric type, the streaming ingestion performance of Hudi 1.1 is about 3.5 times that of Hudi 1.0. The performance gain mainly comes from the optimizations introduced in RFC-84 and RFC-87, which reduce the shuffle SerDe overhead in the ingestion pipeline and internal Avro SerDe costs in the writer.</li>
<li class="">Streaming ingestion throughput of Paimon is slightly higher than that of Hudi 1.1. Through detailed profiling and analysis, we found that this performance gap mainly stems from the fact that each <code>HoodieRecord</code> contains 5 extra String-type metadata fields by default, and in simple schema scenarios like Schema1, these record-level additional fields have a significant performance impact.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Benchmark results for Schema1" src="/assets/images/benchmark-schema1-e57e652fe29a9dcf5fd546b31c19421b.png" width="991" height="853" class="img_ev3q"></p>
<ul>
<li class="">For schemas where most fields are of STRING type, Hudi 1.1 achieves the best streaming ingestion performance. Based on the profiling analysis, we found that when the data fields are all strings, Paimon&#x27;s approach of directly writing to Parquet files incurs noticeable compression overhead, which negatively impacts throughput—even though the benchmark tests used SNAPPY, the fastest available compression codec. Hudi, on the other hand, writes incremental data in row-based Avro format to log files. While its compression ratio is lower, this approach is more favorable for ingestion throughput across a variety of workloads.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Benchmark results for string-heavy schemas" src="/assets/images/benchmark-string-schemas-52fce427657dee18c89ea3bd4c54e9c6.png" width="1622" height="1081" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary" translate="no">​</a></h2>
<p>The optimizations in Hudi 1.1 around writer performance for Flink have brought significant, multi-fold improvements to streaming ingestion throughput. These enhancements are transparent and backward-compatible, allowing users to seamlessly upgrade their jobs from earlier Hudi versions to the latest version and enjoy the substantial performance gains without any additional operational overhead.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/apache/hudi/edit/asf-site/website/blog/blog/2025-12-10-apache-hudi-11-deep-dive-optimizing-streaming-ingestion-with-flink.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2025/12/12/from-batch-to-streaming-accelerating-data-freshness-in-ubers-data-lake"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">From Batch to Streaming: Accelerating Data Freshness in Uber&#x27;s Data Lake</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2025/12/03/Mastering-Schema-Evolution-with-Apache-Hudi"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Mastering Schema Evolution with Apache Hudi</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#optimized-serde-between-flink-operators" class="table-of-contents__link toc-highlight">Optimized SerDe Between Flink Operators</a></li><li><a href="#new-performant-flink-native-writers" class="table-of-contents__link toc-highlight">New Performant Flink-Native Writers</a><ul><li><a href="#rfc-87-a-flink-native-write-path" class="table-of-contents__link toc-highlight">RFC-87: A Flink-Native Write Path</a></li></ul></li><li><a href="#eliminate-bytes-copy-for-mor-log-file-writing" class="table-of-contents__link toc-highlight">Eliminate Bytes Copy for MOR Log File Writing</a><ul><li><a href="#improvement-in-hudi-11" class="table-of-contents__link toc-highlight">Improvement in Hudi 1.1</a></li></ul></li><li><a href="#benchmark" class="table-of-contents__link toc-highlight">Benchmark</a><ul><li><a href="#cluster-environment" class="table-of-contents__link toc-highlight">Cluster Environment</a></li><li><a href="#streaming-ingestion-scenario" class="table-of-contents__link toc-highlight">Streaming Ingestion Scenario</a></li><li><a href="#benchmark-results" class="table-of-contents__link toc-highlight">Benchmark Results</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footerCustom_j_zv"><div class="container container-fluid container_y1z5"><div class="brand_kMBW"><a href="https://hudi.apache.org/" rel="noopener noreferrer" class="footerLogoLink_DDai"><img src="/assets/images/hudi.png" alt="Apache Hudi™" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/assets/images/hudi.png" alt="Apache Hudi™" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="links_AXCu"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">About</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/2021/07/21/streaming-data-lake-platform">Our Vision</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/community/team">Team</a></li><li class="footer__item"><a class="footer__link-item" href="/releases/release-1.1.0">Releases</a></li><li class="footer__item"><a class="footer__link-item" href="/releases/download">Download</a></li><li class="footer__item"><a class="footer__link-item" href="/powered-by">Adopters</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quick-start-guide">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/tutorial-series">Tutorial Series</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/talks">Talks</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/videos">Video Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/faq">FAQ</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Hudi On Cloud</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/s3_hoodie">AWS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/gcs_hoodie">Google Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/oss_hoodie">Alibaba Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/azure_hoodie">Microsoft Azure</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cos_hoodie">Tencent Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/ibm_cos_hoodie">IBM Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/oci_hoodie">Oracle Cloud</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community/get-involved">Get Involved</a></li><li class="footer__item"><a href="https://join.slack.com/t/apache-hudi/shared_invite/zt-33fabmxb7-Q7QSUtNOHYCwUdYM8LbauA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/apache/hudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/ApacheHudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCs7AhE0BWaEPZSChrBR-Muw" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/apache-hudi/?viewAsMember=true" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:dev-subscribe@hudi.apache.org?Subject=SubscribeToHudi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Apache</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li><li class="footer__item"><a href="https://www.apache.org/licenses" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a class="footer__link-item" href="/asf/privacy">Privacy</a></li><li class="footer__item"><a class="footer__link-item" href="/asf/telemetry">Telemetry</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li></ul></div></div></div><div class="legal_MFbX"><div class="footer__copyright">Copyright © 2021 <a href="https://apache.org">The Apache Software Foundation</a>, Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0"> Apache License, Version 2.0</a>. Hudi, Apache and the Apache feather logo are trademarks of The Apache Software Foundation.<img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=8f594acf-9b77-44fb-9475-3e82ead1910c"><img referrerpolicy="no-referrer-when-downgrade" src="https://analytics.apache.org/matomo.php?idsite=47&amp;rec=1"></div></div></div></footer></div>
</body>
</html>