"use strict";(self.webpackChunkhudi=self.webpackChunkhudi||[]).push([[58692],{4226:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-10-PuppyGraph-Query-3-c324707053b02056cc824229fd1d1ac0.png"},12274:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-4-Sample-Architecture-of-PuppyGraph-Hudi-adcd64f4ffaf1a8c9b6e13f7d9d07e4a.png"},16738:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-11-PuppyGraph-Query-4-66848df36086049fd3ac42b78a5de47c.png"},18949:e=>{e.exports=JSON.parse('{"permalink":"/cn/blog/2025/10/02/Real-Time-Cloud-Security-Graphs-Hudi+PuppyGraph","editUrl":"https://github.com/apache/hudi/edit/asf-site/website/blog/blog/2025-10-02-Real-Time-Cloud-Security-Graphs-Hudi+PuppyGraph.mdx","source":"@site/blog/2025-10-02-Real-Time-Cloud-Security-Graphs-Hudi+PuppyGraph.mdx","title":"Real-Time Cloud Security Graphs with Apache Hudi and PuppyGraph","description":"CrowdStrike\u2019s 2025 Global Threat Report puts average eCrime breakout time at 48 minutes, with the fastest at 51 seconds. This means that by the time security teams are even alerted about the potential breach, attackers have already long infiltrated the system. And that\u2019s assuming they even get alerted. Cloud environments generate massive amounts of access logs, configuration changes, alerts, and telemetry. Reviewing these events in isolation rarely surfaces patterns like lateral movement or privilege escalation.","date":"2025-10-02T00:00:00.000Z","tags":[{"inline":true,"label":"Apache Hudi","permalink":"/cn/blog/tags/apache-hudi"},{"inline":true,"label":"PuppyGraph","permalink":"/cn/blog/tags/puppy-graph"},{"inline":true,"label":"security","permalink":"/cn/blog/tags/security"}],"readingTime":10.8,"hasTruncateMarker":false,"authors":[{"name":"Jaz Samantha Ku, in collaboration with Shiyan Xu","key":null,"page":null}],"frontMatter":{"title":"Real-Time Cloud Security Graphs with Apache Hudi and PuppyGraph","excerpt":"Hudi tables support fast upserts and incremental processing. PuppyGraph queries relationships in place using openCypher or Gremlin. In this blog, we explore how to get started with real-time security graph analytics at scale using the data already stored in your Hudi lakehouse tables.","author":"Jaz Samantha Ku, in collaboration with Shiyan Xu","category":"blog","image":"/assets/images/blog/2025-10-02-Real-Time-Cloud-Security-Graphs-Hudi+PuppyGraph/fig-4-Sample-Architecture-of-PuppyGraph-Hudi.png","tags":["Apache Hudi","PuppyGraph","security"]},"unlisted":false,"nextItem":{"title":"Automatic Record Key Generation in Apache Hudi","permalink":"/cn/blog/2025/09/17/hudi-auto-gen-keys"}}')},22188:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-3-Architecture-with-Graph-Database-vs-with-PuppyGraph-c6601e01f1e7ae2fcd8ffcc58aec90ac.png"},23155:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-6-Schema-Page-in-PuppyGraph-UI-ff0eb0aac444ad00b098145a9c84fe69.png"},28453:(e,a,t)=>{t.d(a,{R:()=>r,x:()=>o});var s=t(96540);const n={},i=s.createContext(n);function r(e){const a=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(i.Provider,{value:a},e.children)}},37815:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-5-PuppyGraph-Login-Page-9581d45eebc05450a36b8fa666557b00.png"},38681:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-8-PuppyGraph-Query-1-9d56715c417b1f35667d91d153df9547.png"},52977:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-2-PuppyGraph_Supported_Data_Sources-530816b1bc98047b2113f8f1fb791b8c.png"},64239:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>h});var s=t(18949),n=t(74848),i=t(28453);const r={title:"Real-Time Cloud Security Graphs with Apache Hudi and PuppyGraph",excerpt:"Hudi tables support fast upserts and incremental processing. PuppyGraph queries relationships in place using openCypher or Gremlin. In this blog, we explore how to get started with real-time security graph analytics at scale using the data already stored in your Hudi lakehouse tables.",author:"Jaz Samantha Ku, in collaboration with Shiyan Xu",category:"blog",image:"/assets/images/blog/2025-10-02-Real-Time-Cloud-Security-Graphs-Hudi+PuppyGraph/fig-4-Sample-Architecture-of-PuppyGraph-Hudi.png",tags:["Apache Hudi","PuppyGraph","security"]},o=void 0,l={authorsImageUrls:[void 0]},h=[{value:"Why Apache Hudi for Cybersecurity Data?",id:"why-apache-hudi-for-cybersecurity-data",level:2},{value:"Why PuppyGraph for Cybersecurity Data?",id:"why-puppygraph-for-cybersecurity-data",level:2},{value:"Traditional Analytics on the Lake",id:"traditional-analytics-on-the-lake",level:3},{value:"Dedicated Graph Databases",id:"dedicated-graph-databases",level:3},{value:"How PuppyGraph Helps",id:"how-puppygraph-helps",level:3},{value:"Real-World Use Case",id:"real-world-use-case",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Data Preparation",id:"data-preparation",level:4},{value:"Loading Data",id:"loading-data",level:4},{value:"Modeling the Graph",id:"modeling-the-graph",level:4},{value:"Sample Queries",id:"sample-queries",level:3},{value:"Conclusion",id:"conclusion",level:2}];function c(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.a,{href:"https://www.crowdstrike.com/en-us/global-threat-report/",children:"CrowdStrike\u2019s 2025 Global Threat Report"})," puts average eCrime breakout time at 48 minutes, with the fastest at 51 seconds. This means that by the time security teams are even alerted about the potential breach, attackers have already long infiltrated the system. And that\u2019s assuming they even get alerted. Cloud environments generate massive amounts of access logs, configuration changes, alerts, and telemetry. Reviewing these events in isolation rarely surfaces patterns like lateral movement or privilege escalation."]}),"\n",(0,n.jsx)(a.p,{children:"Security tools such as SIEM, CSPM, and cloud workload protection need relationship-based analysis. It is not only a login attempt or a policy change, but also who acted, which systems were touched, what privileges were active, and what happened next. Event-centric methods struggle to answer those questions at scale. Graph analysis fits better because it captures paths and context across entities."}),"\n",(0,n.jsx)(a.p,{children:"To keep up, the data pipeline must support:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Continuous upserts with low lag so detections run on the latest state"}),"\n",(0,n.jsx)(a.li,{children:"Incremental consumption so analytics read only \u201cwhat changed since T\u201d"}),"\n",(0,n.jsx)(a.li,{children:"A rewindable timeline so responders can review state during investigations"}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"With Apache Hudi and PuppyGraph, this becomes straightforward. Hudi tables support fast upserts and incremental processing. PuppyGraph queries relationships in place using openCypher or Gremlin. In this blog, we explore how to get started with real-time security graph analytics at scale using the data already stored in your Hudi lakehouse tables."}),"\n",(0,n.jsx)(a.h2,{id:"why-apache-hudi-for-cybersecurity-data",children:"Why Apache Hudi for Cybersecurity Data?"}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.a,{href:"https://hudi.apache.org/",children:"Apache Hudi"})," is an open data lakehouse platform that brings ACID transaction guarantees to data lakes. It enables efficient, record-level updates and deletes on massive datasets, which makes it a strong foundation for storing and analyzing cybersecurity data such as logs, telemetry, and threat intelligence. Its combination of performance, flexibility, and broad ecosystem integration is well-suited for threat detection, forensic investigation, and compliance work."]}),"\n",(0,n.jsxs)(a.p,{children:["Hudi speeds up large-scale security analytics through features that keep tables both current and query-efficient. Hudi writers excel at handling continuous, mutable workloads without requiring costly full rewrites. Hudi\u2019s ",(0,n.jsx)(a.a,{href:"https://hudi.apache.org/docs/metadata",children:"multi-modal indexing subsystem"}),", backed by its internal metadata table, offers efficient lookups and data skipping, dramatically accelerating queries that scan massive log sets to isolate suspicious activity. Hudi keeps tables updatable and queryable as they change, with time-travel and incremental reads for point-in-time forensic analysis."]}),"\n",(0,n.jsxs)(a.p,{children:["Even as data volumes grow, operations remain manageable. Hudi tracks every commit on a timeline, enabling powerful time-travel queries for historical investigations. Asynchronous table services like ",(0,n.jsx)(a.a,{href:"https://hudi.apache.org/docs/compaction",children:"compaction"}),", ",(0,n.jsx)(a.a,{href:"https://hudi.apache.org/docs/clustering",children:"clustering"}),", ",(0,n.jsx)(a.a,{href:"https://hudi.apache.org/docs/cleaning",children:"cleaning"}),", and ",(0,n.jsx)(a.a,{href:"https://hudi.apache.org/docs/metadata_indexing",children:"indexing"})," run in the background to maintain peak performance and storage health while minimizing disruption to ingestion pipelines. Furthermore, its consistent commit and delete semantics support the creation of reliable audit trails, simplify data retention policies, and help meet privacy requirements."]}),"\n",(0,n.jsx)("figure",{children:(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.img,{src:t(84548).A+"",width:"1989",height:"1344"}),"\n",(0,n.jsxs)("figcaption",{children:["The ",(0,n.jsx)(a.a,{href:"https://hudi.apache.org/docs/hudi_stack",children:"Apache Hudi Stack"})]})]})}),"\n",(0,n.jsx)(a.p,{children:"Hudi also integrates seamlessly with the tools security teams already use. You can stream data from Apache Kafka or Debezium CDC into Hudi, register tables in Hive Metastore or AWS Glue Catalog, and query them from popular query engines like Apache Spark, Apache Flink, Presto, Trino, or Amazon Athena. PuppyGraph connects to the same Hudi tables and runs openCypher or Gremlin queries directly on them via the user access layer, so you get real-time graph analytics on the lake with no ETL and no data duplication."}),"\n",(0,n.jsx)(a.h2,{id:"why-puppygraph-for-cybersecurity-data",children:"Why PuppyGraph for Cybersecurity Data?"}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.a,{href:"https://puppygraph.com/",children:"PuppyGraph"})," is the first real-time, zero-ETL graph query engine. It lets data teams query existing relational stores as a single graph and get up and running in under 10 minutes, avoiding the cost, latency, and maintenance of a separate graph database. To understand why this is so important, let\u2019s take a look at the status quo."]}),"\n",(0,n.jsx)(a.h3,{id:"traditional-analytics-on-the-lake",children:"Traditional Analytics on the Lake"}),"\n",(0,n.jsx)(a.p,{children:"Security teams already store logs, configs, and alerts in a lakehouse. SQL engines are great for counts, filters, rollups, and point lookups. They struggle when questions depend on relationships. Lateral movement, privilege escalation, and blast radius span many tables and time windows. Each new join adds complexity, pushes latency up, and breaks easily when schemas evolve or events arrive late. You can stitch context with views and pipelines, but it is fragile and slow to adapt."}),"\n",(0,n.jsx)(a.h3,{id:"dedicated-graph-databases",children:"Dedicated Graph Databases"}),"\n",(0,n.jsx)(a.p,{children:"Graphs make paths and neighborhoods first class. Graph queries let you answer \u201cwhat connects to what\u201d in a way that makes sense, without the need for confusing data joins. The tradeoff is operations and freshness. Most graph databases want their own storage. That means ETL, a second copy, and lag between source and graph. Continuous upserts are heavy because every change can touch nodes, edges, and multiple indexes. Running a separate cluster adds backups, upgrades, sizing, and vendor-specific tuning. During an incident, that overhead shows up as stale data and slower investigations."}),"\n",(0,n.jsx)(a.h3,{id:"how-puppygraph-helps",children:"How PuppyGraph Helps"}),"\n",(0,n.jsx)(a.p,{children:'PuppyGraph is not a traditional graph database but a graph query engine designed to run directly on top of your existing data infrastructure without costly and complex ETL (Extract, Transform, Load) processes. This "zero-ETL" approach is its core differentiator, allowing you to query relational data in data warehouses, data lakes, and databases as a unified graph model in minutes.'}),"\n",(0,n.jsxs)(a.p,{children:["Instead of migrating data into a specialized store, PuppyGraph connects to sources including ",(0,n.jsx)(a.a,{href:"https://www.puppygraph.com/blog/postgresql-graph-database",children:"PostgreSQL"}),", ",(0,n.jsx)(a.a,{href:"https://docs.puppygraph.com/connecting/connecting-to-iceberg/?h=ice",children:"Apache Iceberg"}),", ",(0,n.jsx)(a.a,{href:"https://docs.puppygraph.com/connecting/connecting-to-apache-hudi/",children:"Apache Hudi"}),", ",(0,n.jsx)(a.a,{href:"https://docs.puppygraph.com/connecting/connecting-to-bigquery/?h=bigq",children:"BigQuery"}),", and others, then builds a virtual graph layer over them. Graph models are defined through simple JSON schema files, making it easy to update, version, or switch graph views without touching the underlying data. From there, you can quickly begin exploring your data with graph queries written in Gremlin or openCypher."]}),"\n",(0,n.jsx)("figure",{children:(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.img,{src:t(52977).A+"",width:"1313",height:"745"}),"\n",(0,n.jsx)("figcaption",{children:"PuppyGraph Supported Data Sources"})]})}),"\n",(0,n.jsx)("figure",{children:(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.img,{src:t(22188).A+"",width:"1497",height:"843"}),"\n",(0,n.jsx)("figcaption",{children:"Architecture with Graph Database vs. with PuppyGraph"})]})}),"\n",(0,n.jsx)(a.p,{children:"This approach aligns with the broader shift in modern data stacks to separate compute from storage. You keep data where it belongs and scale query power independently, which supports petabyte-level workloads without duplicating data or managing fragile pipelines."}),"\n",(0,n.jsx)(a.h2,{id:"real-world-use-case",children:"Real-World Use Case"}),"\n",(0,n.jsx)(a.p,{children:"We have shown why cloud security benefits from a relationship-first view of identities, resources, and events. In this demo, we\u2019ll show how easy it is to begin querying your cloud security data as a graph. Apache Hudi keeps those tables current with streaming upserts and an investigation-friendly timeline. PuppyGraph lets you query your existing lake tables as a graph. Together they give you real-time security graph analytics on the data you already store."}),"\n",(0,n.jsx)(a.p,{children:"Getting started is straightforward. You will deploy the stack, load security data into Hudi, connect PuppyGraph to your catalog, define a graph view, and run a few queries. All in a matter of minutes."}),"\n",(0,n.jsx)("figure",{children:(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.img,{src:t(12274).A+"",width:"858",height:"1100"}),"\n",(0,n.jsx)("figcaption",{children:"Sample Architecture of PuppyGraph + Hudi"})]})}),"\n",(0,n.jsx)(a.p,{children:"The components of this demo project include:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Storage: MinIO/S3 \u2013 Object store for Hudi data"}),"\n",(0,n.jsx)(a.li,{children:"Data Lakehouse: Apache Hudi \u2013 Brings database functionality to your data lakes"}),"\n",(0,n.jsx)(a.li,{children:"Catalog: Hive Metastore \u2013 Backed by Postgres"}),"\n",(0,n.jsxs)(a.li,{children:["Compute engines:","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Spark \u2013 Initial table writes"}),"\n",(0,n.jsx)(a.li,{children:"PuppyGraph \u2013 Graph query engine for complex, multi-hop graph queries"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(a.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,n.jsx)(a.p,{children:"This tutorial assumes that you have the following:"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Docker"})," and ",(0,n.jsx)(a.strong,{children:"Docker"})," ",(0,n.jsx)(a.strong,{children:"Compose"})," (for setting up the Docker container)"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Python 3"})," (for managing dependencies)"]}),"\n",(0,n.jsx)(a.li,{children:(0,n.jsx)(a.a,{href:"https://github.com/puppygraph/puppygraph-getting-started/tree/main/integration-demos/hudi-demo",children:"PuppyGraph-Hudi Demo Repository"})}),"\n"]}),"\n",(0,n.jsx)(a.h4,{id:"data-preparation",children:"Data Preparation"}),"\n",(0,n.jsx)(a.p,{children:"Before we can load our data into our Hudi tables, we need to make sure they\u2019re in the correct file format. Hudi currently supports Parquet and ORC for base files, and we\u2019ll be going with Parquet for this demo:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:"python3 -m venv demo\nsource demo/bin/activate\npip install -r requirements.txt\npython3 CsvToParquet.py ./csv_data ./parquet_data\n"})}),"\n",(0,n.jsx)(a.p,{children:"Since we\u2019ll be connecting to the Hudi Catalog via the Hive Metastore (HMS), we also have to install the following dependencies:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:"mkdir -p lib\ncurl -L -o lib/postgresql-42.5.1.jar \\\nhttps://repo1.maven.org/maven2/org/postgresql/postgresql/42.5.1/postgresql-42.5.1.jar\n\ncurl -L -o lib/hadoop-aws-3.3.4.jar \\\nhttps://repo1.maven.org/maven2/org/apache/hadoop/hadoop-aws/3.3.4/hadoop-aws-3.3.4.jar\n\ncurl -L -o lib/aws-java-sdk-bundle-1.12.262.jar \\\nhttps://repo1.maven.org/maven2/com/amazonaws/aws-java-sdk-bundle/1.12.262/aws-java-sdk-bundle-1.12.262.jar\n"})}),"\n",(0,n.jsx)(a.h4,{id:"loading-data",children:"Loading Data"}),"\n",(0,n.jsx)(a.p,{children:"With all our dependencies installed and data prepared, we can launch the required services:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:"docker compose up -d\n"})}),"\n",(0,n.jsx)(a.p,{children:"Once everything is up and running, we can finally populate the tables with our data:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:"docker compose exec spark /opt/spark/bin/spark-sql -f /init.sql\n"})}),"\n",(0,n.jsx)(a.h4,{id:"modeling-the-graph",children:"Modeling the Graph"}),"\n",(0,n.jsxs)(a.p,{children:["Now that our data is loaded in, we can log into the PuppyGraph Web UI at ",(0,n.jsx)(a.a,{href:"http://localhost:8081",children:"http://localhost:8081"})," with the default credentials (username: puppygraph, password: puppygraph123)"]}),"\n",(0,n.jsx)("figure",{children:(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.img,{src:t(37815).A+"",width:"455",height:"410"}),"\n",(0,n.jsx)("figcaption",{children:"PuppyGraph Login Page"})]})}),"\n",(0,n.jsx)(a.p,{children:"To model your data as a graph, you can simply select the file `schema.json` in the Upload Graph Schema JSON section and click on Upload."}),"\n",(0,n.jsx)("figure",{children:(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.img,{src:t(23155).A+"",width:"1600",height:"907"}),"\n",(0,n.jsx)("figcaption",{children:"Schema Page in PuppyGraph UI"})]})}),"\n",(0,n.jsx)(a.p,{children:"Once you see your graph schema loaded in, you\u2019re ready to start querying your data as a graph."}),"\n",(0,n.jsx)("figure",{children:(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.img,{src:t(72222).A+"",width:"1600",height:"907"}),"\n",(0,n.jsx)("figcaption",{children:"Loaded Schema in PuppyGraph UI"})]})}),"\n",(0,n.jsx)(a.h3,{id:"sample-queries",children:"Sample Queries"}),"\n",(0,n.jsx)(a.p,{children:"By modeling the network infrastructure as a graph, users can identify potential security risks, such as:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Public IP addresses exposed to the internet"}),"\n",(0,n.jsx)(a.li,{children:"Network interfaces not protected by any security group"}),"\n",(0,n.jsx)(a.li,{children:"Roles granted excessive access permissions"}),"\n",(0,n.jsx)(a.li,{children:"Security groups with overly permissive ingress rules"}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"Listed below are some sample queries you can try running to explore the data:"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsx)(a.li,{children:"Tracing Admin Access Paths from Users to Internet Gateways"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-groovy",children:"g.V().hasLabel('User').as('user')\n .outE('ACCESS').has('access_level', 'admin').as('edge')\n .inV()\n .path()\n"})}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{src:t(38681).A+"",width:"1600",height:"907"})}),"\n",(0,n.jsxs)(a.ol,{start:"2",children:["\n",(0,n.jsx)(a.li,{children:"Find all public IP addresses exposed to the internet, along with their associated virtual machine instances, security groups, subnets, VPCs, internet gateways, and users, displaying all these entities in the traversal path."}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-groovy",children:" g.V().hasLabel('PublicIP').as('ip')\n .in('HAS_PUBLIC_IP').as('ni')\n .in('PROTECTS').hasLabel('SecurityGroup').as('sg')\n .out('HAS_RULE').hasLabel('IngressRule').as('rule')\n .where(\n   __.out('ALLOWS_TRAFFIC_FROM').hasLabel('InternetGateway')\n )\n .select('ni')\n   .out('ATTACHED_TO').hasLabel('VMInstance').as('vm')\n .select('ni')\n   .in('HOSTS_INTERFACE').hasLabel('Subnet').as('subnet')\n   .in('CONTAINS').hasLabel('VPC').as('vpc')\n   .in('GATEWAY_TO').hasLabel('InternetGateway').as('igw')\n   .in('ACCESS').hasLabel('User').as('user')\n .path()\n .limit(1000)\n"})}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{src:t(82601).A+"",width:"1600",height:"907"})}),"\n",(0,n.jsxs)(a.ol,{start:"3",children:["\n",(0,n.jsx)(a.li,{children:"Find roles that have been granted excessive access permissions, along with their associated virtual machine instances."}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-groovy",children:"g.V().hasLabel('Role').as('role')\n.where(\n  __.out('ALLOWS_ACCESS_TO').count().is(gt(4L))\n)\n.out('ALLOWS_ACCESS_TO').hasLabel('Resource').as('resource')\n.select('role')\n.in('ASSIGNED_ROLE').hasLabel('VMInstance').as('vm')\n.path()\n"})}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{src:t(4226).A+"",width:"1600",height:"907"})}),"\n",(0,n.jsxs)(a.ol,{start:"4",children:["\n",(0,n.jsx)(a.li,{children:"Find security groups that have ingress rules permitting traffic from any IP address (0.0.0.0/0) to sensitive ports (22 or 3389), and retrieve the associated ingress rules, network interfaces, and virtual machine instances in the traversal path."}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-groovy",children:"g.V().hasLabel('SecurityGroup').as('sg')\n .out('HAS_RULE')\n   .has('source', '0.0.0.0/0')\n   .has('port_range', P.within('22', '3389'))\n   .hasLabel('IngressRule').as('rule')\n .in('HAS_RULE').as('sg')\n .out('PROTECTS').hasLabel('NetworkInterface').as('ni')\n .out('ATTACHED_TO').hasLabel('VMInstance').as('vm')\n .path()\n"})}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{src:t(16738).A+"",width:"1600",height:"907"})}),"\n",(0,n.jsx)(a.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsx)(a.p,{children:"Real-time security work comes down to two needs: fresh tables and connected questions. Apache Hudi keeps lakehouse data current with streaming upserts, incremental reads, and a rewindable timeline. PuppyGraph reads those same tables in place and runs multi-hop graph queries with openCypher or Gremlin. One data copy. No ETL."}),"\n",(0,n.jsx)(a.p,{children:"The result is faster investigations and clearer decisions. You can trace attack paths, size blast radius, and correlate alerts to recent changes while keeping governance and access controls in a single lake. When you need to look back, time travel gives you point-in-time views without rebuilding pipelines."})]})}function d(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},72222:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-7-Loaded-Schema-in-PuppyGraph-UI-b32e7eb53b88d6290b5f463308445bfa.png"},82601:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/fig-9-PuppyGraph-Query-2-59da47f7532f00f65a89d7ac108865a8.png"},84548:(e,a,t)=>{t.d(a,{A:()=>s});const s=t.p+"assets/images/hudi-stack-1-x-86c60e4c27bcc3af1fdf1e78ed48e42d.png"}}]);